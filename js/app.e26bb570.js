(function(){"use strict";var e={3846:function(e,a,t){var l=t(5130),s=t(5753),n=t(6526),r=(t(5524),t(2859)),u=t(3425),o=(t(8111),t(7588),t(1701),t(7642),t(8004),t(3853),t(5876),t(2475),t(5024),t(1698),t(6768)),i=t(144),c=t(4232),d=t(4388);const v=(0,i.KR)(null),m=(0,i.KR)(!1);let p=null;const f=new Promise(e=>{p=e});function b(){const e=(0,o.WQ)("auth");if(!e)throw new Error("Firebase Auth not provided via inject!");return m.value||(0,d.hg)(e,e=>{v.value=e,m.value=!0,p&&p(!0)}),{auth:e,currentUser:v,authInitialized:m,authReady:f}}var g=t(1239);const k={key:0,class:"error"};function y(e,a,t,s,n,r){return(0,o.uX)(),(0,o.CE)("div",null,[a[4]||(a[4]=(0,o.Lk)("h2",null,"Email/Password Authentication",-1)),(0,o.bo)((0,o.Lk)("input",{type:"email","onUpdate:modelValue":a[0]||(a[0]=a=>e.email=a),placeholder:"Email"},null,512),[[l.Jo,e.email]]),(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":a[1]||(a[1]=a=>e.password=a),placeholder:"Password"},null,512),[[l.Jo,e.password]]),(0,o.Lk)("button",{onClick:a[2]||(a[2]=(...a)=>e.signUp&&e.signUp(...a))},"Sign Up"),(0,o.Lk)("button",{onClick:a[3]||(a[3]=(...a)=>e.signIn&&e.signIn(...a))},"Sign In"),e.errorMsg?((0,o.uX)(),(0,o.CE)("p",k,(0,c.v_)(e.errorMsg),1)):(0,o.Q3)("",!0)])}var h=(0,o.pM)({name:"LogIn",setup(){const e=(0,i.KR)(""),a=(0,i.KR)(""),t=(0,i.KR)(null),l=(0,o.WQ)("auth"),s=(0,o.WQ)("db");if(!l||!s)return console.error("Firebase Auth or Database not provided!"),t.value="Authentication services not available.",{};const n=async()=>{t.value=null;try{const t=await(0,d.eJ)(l,e.value,a.value),n=t.user,r=n.uid;console.log("User signed up! UID:",r);const u=(0,g.KR)(s,`users/${r}/profile`);await(0,g.hZ)(u,{email:n.email,createdAt:(new Date).toISOString()}),console.log("User profile created in RTDB.")}catch(n){console.error("Error signing up:",n.message),t.value=n.message}},r=async()=>{t.value=null;try{await(0,d.x9)(l,e.value,a.value),console.log("User signed in!")}catch(s){console.error("Error signing in:",s.message),t.value=s.message}};return{email:e,password:a,signUp:n,signIn:r,errorMsg:t}}}),_=t(1241);const w=(0,_.A)(h,[["render",y],["__scopeId","data-v-4be14ef0"]]);var F=w;t(3579);const x={class:"text-subtitle-2 mb-2"};var E={__name:"DkpModal",props:{modelValue:{type:Boolean,required:!0},item:{type:Object,default:null}},emits:["update:modelValue","saved"],setup(e,{emit:a}){const t=e,l=a,s=(0,o.EW)({get:()=>t.modelValue,set:e=>l("update:modelValue",e)}),n=e=>{l("update:modelValue",e)},r=(0,o.WQ)("db"),u=(0,i.KR)(0),d=(0,i.KR)(""),v=(0,i.KR)(""),m=(0,i.KR)(""),p=(0,i.KR)(0),f=(0,i.KR)({}),b=["Field Raids","Epics","Clan Hall/Fort","Call To Arms","Siege"],k=async()=>{if(t.item&&r)try{const e=(0,g.KR)(r,"events/"),a=await(0,g.Jt)(e);if(a.exists()){const e=a.val();let l=0;const s={};b.forEach(e=>{s[e]=0}),Object.values(e).forEach(e=>{if(console.log("Event:",e.messageTitle,"UsersAttended:",e.usersAttended),e.usersAttended){const a=e.messageTitle||"Untitled Event";if(console.log("Event title:",a,"Is in display list:",b.includes(a)),!b.includes(a))return;const n=Object.values(e.usersAttended).some(e=>(console.log("Checking user:",e,"against item:",t.item),e.userId===t.item.id||e.userId===t.item.user||e.username===t.item.user||e.username===t.item.id));n&&(s[a]=(s[a]||0)+1,l++,console.log("User attended event:",a,"New count:",s[a]))}}),console.log("Final attendance by type:",s),console.log("Total attendance:",l),p.value=l,f.value=s}}catch(e){console.error("Error fetching attendance:",e)}};(0,o.wB)(()=>t.item,async e=>{e&&(u.value=e.dkp||0,d.value=e.user||"",v.value=e.class||"",m.value=e.level||"",await k())},{immediate:!0});const y=async()=>{if(t.item&&r&&d.value)try{const e=t.item.isNew?d.value:t.item.id,a=(0,g.KR)(r,`dkp/${e}`);await(0,g.hZ)(a,{user:d.value,dkp:Number(u.value),class:v.value||"",level:m.value||""}),l("update:modelValue",!1),l("saved")}catch(e){console.error("Error saving user:",e)}};return(a,t)=>{const l=(0,o.g2)("v-card-title"),r=(0,o.g2)("v-text-field"),i=(0,o.g2)("v-col"),b=(0,o.g2)("v-list-subheader"),g=(0,o.g2)("v-table"),k=(0,o.g2)("v-row"),h=(0,o.g2)("v-container"),_=(0,o.g2)("v-card-text"),w=(0,o.g2)("v-spacer"),F=(0,o.g2)("v-btn"),E=(0,o.g2)("v-card-actions"),C=(0,o.g2)("v-card"),R=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.Wv)(R,{"model-value":s.value,"onUpdate:modelValue":n,"max-width":"500px"},{default:(0,o.k6)(()=>[(0,o.bF)(C,null,{default:(0,o.k6)(()=>[(0,o.bF)(l,{class:"text-h5"},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,c.v_)(e.item?.isNew?"Add New User":`${e.item?.user} Details`),1)]),_:1}),(0,o.bF)(_,null,{default:(0,o.k6)(()=>[(0,o.bF)(h,null,{default:(0,o.k6)(()=>[(0,o.bF)(k,{justify:"center"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{cols:"12"},{default:(0,o.k6)(()=>[e.item?((0,o.uX)(),(0,o.Wv)(r,{key:0,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),label:"Username",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,o.Q3)("",!0),e.item?((0,o.uX)(),(0,o.Wv)(r,{key:1,modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=e=>u.value=e),modelModifiers:{number:!0},label:"DKP",type:"number",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,o.Q3)("",!0),e.item?((0,o.uX)(),(0,o.Wv)(r,{key:2,modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=e=>v.value=e),label:"Class",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,o.Q3)("",!0),e.item?((0,o.uX)(),(0,o.Wv)(r,{key:3,modelValue:m.value,"onUpdate:modelValue":t[3]||(t[3]=e=>m.value=e),label:"Level",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,o.Q3)("",!0),(0,o.Lk)("div",x," Total Event Attendance: "+(0,c.v_)(p.value),1)]),_:1}),(0,o.bF)(i,{cols:"12",class:"attendance-list pa-4"},{default:(0,o.k6)(()=>[(0,o.bF)(b,null,{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.eW)("Attendance by Event Type:",-1)])]),_:1}),(0,o.bF)(g,{dense:""},{header:(0,o.k6)(()=>[...t[6]||(t[6]=[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Event Type"),(0,o.Lk)("th",null,"Attendance Count")],-1)])]),default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(f.value,(e,a)=>((0,o.uX)(),(0,o.CE)("tr",{key:a},[(0,o.Lk)("td",null,(0,c.v_)(a),1),(0,o.Lk)("td",null,(0,c.v_)(e),1)]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),(0,o.bF)(E,null,{default:(0,o.k6)(()=>[(0,o.bF)(w),(0,o.bF)(F,{color:"primary",variant:"text",onClick:t[4]||(t[4]=e=>n(!1))},{default:(0,o.k6)(()=>[...t[7]||(t[7]=[(0,o.eW)(" Cancel ",-1)])]),_:1}),(0,o.bF)(F,{color:"primary",variant:"text",onClick:y},{default:(0,o.k6)(()=>[...t[8]||(t[8]=[(0,o.eW)(" Save ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const C=(0,_.A)(E,[["__scopeId","data-v-040d4274"]]);var R=C;const U={class:"search-container"},W={class:"d-flex align-center justify-center"},L={class:"text-center"},V={class:"text-center"};var K={__name:"DkpTable",props:{users:{type:Array,default:()=>[]},events:{type:Object,default:()=>({})},eventTypes:{type:Array,default:()=>[]},attendanceData:{type:Object,default:()=>({})}},emits:["user-updated"],setup(e,{emit:a}){const t=a,l=(0,i.KR)(""),s=(0,i.KR)(!1),n=(0,i.KR)(null),r=e=>{n.value=e,s.value=!0},u=["Field Raids","Epics","Clan Hall/Fort","Call To Arms","Siege"],d=(0,o.EW)(()=>{const e=[{align:"center",key:"user",sortable:!0,title:"User Name",width:"150px"},{key:"class",align:"center",title:"Class",sortable:!0,width:"120px"},{key:"level",align:"center",title:"Level",sortable:!0,width:"80px"},{key:"dkp",align:"center",title:"DKP",width:"100px",sortable:!0}],a=u.map(e=>({key:`event_${e}`,align:"center",title:e,sortable:!0,width:"100px"}));return[...e,...a,{key:"actions",align:"center",title:"Actions",width:"80px"}]}),v=()=>{t("user-updated")};return(a,t)=>{const u=(0,o.g2)("v-icon"),i=(0,o.g2)("v-text-field"),m=(0,o.g2)("v-btn"),p=(0,o.g2)("v-data-table"),f=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.Wv)(f,{class:"pa-4 mx-auto",id:"card-container"},{title:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.Lk)("div",{class:"d-flex py-2"},[(0,o.Lk)("h2",{class:"text-h4 font-weight-bold"}," The White Order Lineage 2 Users ")],-1),(0,o.Lk)("hr",null,null,-1)])]),text:(0,o.k6)(()=>[(0,o.Lk)("div",U,[(0,o.bF)(i,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),label:"Search",variant:"underlined","hide-details":"","single-line":"",class:"search-field"},{"prepend-inner":(0,o.k6)(()=>[(0,o.bF)(u,{color:"#1f9ee5"},{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("mdi-magnify",-1)])]),_:1})]),_:1},8,["modelValue"])])]),default:(0,o.k6)(()=>[(0,o.bF)(p,{hover:"",headers:d.value,items:e.users,search:l.value,"fixed-header":"",class:"table-container",density:"comfortable"},{["item.user"]:(0,o.k6)(({item:e})=>[(0,o.Lk)("div",W,[(0,o.bF)(u,{color:"#1f9ee5",class:"me-2"},{default:(0,o.k6)(()=>[...t[4]||(t[4]=[(0,o.eW)("mdi-account",-1)])]),_:1}),(0,o.eW)(" "+(0,c.v_)(e.user),1)])]),["item.class"]:(0,o.k6)(({item:e})=>[(0,o.Lk)("div",L,(0,c.v_)(e.class||"-"),1)]),["item.level"]:(0,o.k6)(({item:e})=>[(0,o.Lk)("div",V,(0,c.v_)(e.level||"-"),1)]),["item.actions"]:(0,o.k6)(({item:e})=>[(0,o.bF)(m,{size:"small",icon:"",variant:"text",color:"#1f9ee5",onClick:a=>r(e)},{default:(0,o.k6)(()=>[(0,o.bF)(u,null,{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.eW)("mdi-pencil",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["headers","items","search"]),(0,o.bF)(R,{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value=e),item:n.value,onSaved:v},null,8,["modelValue","item"])]),_:1})}}};const A=(0,_.A)(K,[["__scopeId","data-v-9a51418a"]]);var X=A,I=(t(4114),t(1527)),P=t.n(I);const O={class:"d-flex justify-space-between align-center py-2"},j={class:"d-flex align-center gap-4"},S={class:"d-flex flex-column"},Q={class:"d-flex align-center"},T={key:0,class:"user-details"},D={key:0},M={key:1},$={key:2},N={class:"d-flex align-center justify-space-between w-100"},J={class:"d-flex align-center"},z={class:"party-count me-2"},B={class:"d-flex flex-column"},Z={class:"d-flex align-center"},H={key:0,class:"user-details"},q={key:0},G={key:1},Y={key:2};var ee={__name:"PartyManager",props:{users:{type:Array,default:()=>[]}},setup(e){const a=e,t=(0,o.WQ)("db"),s=(0,i.KR)(!1),n=(0,i.KR)([]),r=(0,i.KR)([{id:1,name:"Party 1",members:[]},{id:2,name:"Party 2",members:[]},{id:3,name:"Party 3",members:[]},{id:4,name:"Party 4",members:[]}]),u=async e=>{if(t)try{const a=(0,g.KR)(t,"parties"),l=(0,g.P)(a,(0,g.JK)(),(0,g.$1)(1)),s=await(0,g.Jt)(l);if(s.exists()){const a=s.val(),t=Object.values(a)[0];console.log("Loading saved party configuration:",t);const l=new Map;t.unassignedUsers?.forEach(e=>{l.set(e.username,{...e,assignment:"unassigned"})}),t.parties?.forEach(e=>{e.members?.forEach(a=>{l.set(a.username,{...a,assignment:e.id})})}),t.parties&&t.parties.length>0&&(r.value=t.parties.map(e=>({id:e.id,name:e.name||`Party ${e.id}`,members:[]})));const u=[],o={};r.value.forEach(e=>{o[e.id]=[]}),e.forEach(e=>{const a=l.get(e.username);a&&"unassigned"!==a.assignment&&o[a.assignment]?o[a.assignment].push(e):u.push(e)}),n.value=u,r.value.forEach(e=>{e.members=o[e.id]||[]}),console.log("Party configuration loaded successfully")}else console.log("No saved party configuration found, using default"),n.value=e}catch(a){console.error("Error loading party configuration:",a),n.value=e}else n.value=e},d=async()=>{const e=a.users.map(e=>({username:e.user,class:e.class||"",level:e.level||""})).sort((e,a)=>e.username.localeCompare(a.username));await u(e)};(0,o.wB)(()=>a.users,async()=>{await d()},{immediate:!0}),(0,o.sV)(async()=>{a.users.length>0&&await d()});const v=()=>{const e=Math.max(...r.value.map(e=>e.id))+1;r.value.push({id:e,name:`Party ${e}`,members:[]})},m=e=>{const a=r.value[e];n.value.push(...a.members),r.value.splice(e,1),console.log(`Party "${a.name}" deleted locally. Click Save to persist changes.`)},p=async()=>{if(t){s.value=!0;try{const e=new Date,a=e.toISOString(),l=a.replace(/[.#$[\]]/g,"_"),s={timestamp:a,unassignedUsers:n.value,parties:r.value.map(e=>({id:e.id,name:e.name,members:e.members,memberCount:e.members.length}))},u=(0,g.KR)(t,`parties/${l}`);await(0,g.hZ)(u,s),console.log("Parties saved successfully!",s)}catch(e){console.error("Error saving parties:",e)}finally{s.value=!1}}else console.error("Database not available")};return(e,a)=>{const t=(0,o.g2)("v-btn"),u=(0,o.g2)("v-col"),d=(0,o.g2)("v-row"),f=(0,o.g2)("v-card-title"),b=(0,o.g2)("v-icon"),g=(0,o.g2)("v-card-text"),k=(0,o.g2)("v-card"),y=(0,o.g2)("v-text-field"),h=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(h,{fluid:"",class:"pa-0"},{default:(0,o.k6)(()=>[(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{cols:"12"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",O,[a[5]||(a[5]=(0,o.Lk)("h2",{class:"text-h4 font-weight-bold"},"Party Members",-1)),(0,o.Lk)("div",j,[(0,o.bF)(t,{onClick:v,variant:"tonal",color:"#1f9ee5","prepend-icon":"mdi-plus"},{default:(0,o.k6)(()=>[...a[2]||(a[2]=[(0,o.eW)(" Add Party ",-1)])]),_:1}),(0,o.bF)(t,{onClick:p,variant:"tonal",color:"success","prepend-icon":"mdi-content-save",loading:s.value,class:"mx-4"},{default:(0,o.k6)(()=>[...a[3]||(a[3]=[(0,o.eW)(" Save Parties ",-1)])]),_:1},8,["loading"]),a[4]||(a[4]=(0,o.Lk)("span",{class:"text-caption text-medium-emphasis"}," Use DKP Table to add/edit users ",-1))])]),a[6]||(a[6]=(0,o.Lk)("hr",null,null,-1))]),_:1})]),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{cols:"12",lg:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(k,{class:"party-card",id:"user-pool-card"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{class:"text-center"},{default:(0,o.k6)(()=>[...a[7]||(a[7]=[(0,o.eW)("Available Users",-1)])]),_:1}),(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)((0,i.R1)(P()),{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),group:"users","item-key":"username",class:"user-pool"},{item:(0,o.k6)(({element:e})=>[(0,o.bF)(k,{class:"user-card mb-2"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{class:"d-flex align-center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",S,[(0,o.Lk)("div",Q,[(0,o.bF)(b,{color:"#1f9ee5",class:"me-2"},{default:(0,o.k6)(()=>[...a[8]||(a[8]=[(0,o.eW)("mdi-account",-1)])]),_:1}),(0,o.eW)(" "+(0,c.v_)(e.username),1)]),e.class||e.level?((0,o.uX)(),(0,o.CE)("div",T,[e.class?((0,o.uX)(),(0,o.CE)("span",D,(0,c.v_)(e.class),1)):(0,o.Q3)("",!0),e.class&&e.level?((0,o.uX)(),(0,o.CE)("span",M," · ")):(0,o.Q3)("",!0),e.level?((0,o.uX)(),(0,o.CE)("span",$,"Level "+(0,c.v_)(e.level),1)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,o.bF)(u,{cols:"12",lg:"7"},{default:(0,o.k6)(()=>[(0,o.bF)(d,{style:{width:"100%"}},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.value,(e,s)=>((0,o.uX)(),(0,o.Wv)(u,{key:s,cols:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(k,{class:"party-card"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{class:"text-center party-title-container"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",N,[(0,o.bF)(y,{modelValue:e.name,"onUpdate:modelValue":a=>e.name=a,variant:"plain",class:"party-name-field","hide-details":"",density:"compact",onClick:a[1]||(a[1]=(0,l.D$)(()=>{},["stop"]))},null,8,["modelValue","onUpdate:modelValue"]),(0,o.Lk)("div",J,[(0,o.Lk)("span",z,"("+(0,c.v_)(e.members.length)+")",1),(0,o.bF)(t,{icon:"",size:"small",variant:"text",color:"error",onClick:e=>m(s)},{default:(0,o.k6)(()=>[(0,o.bF)(b,{size:"medium"},{default:(0,o.k6)(()=>[...a[9]||(a[9]=[(0,o.eW)("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])])])]),_:2},1024),(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)((0,i.R1)(P()),{modelValue:e.members,"onUpdate:modelValue":a=>e.members=a,group:"users","item-key":"username",class:"party-drop-zone"},{item:(0,o.k6)(({element:e})=>[(0,o.bF)(k,{class:"user-card mb-1"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{class:"d-flex align-center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",B,[(0,o.Lk)("div",Z,[(0,o.bF)(b,{color:"#1f9ee5",class:"me-2"},{default:(0,o.k6)(()=>[...a[10]||(a[10]=[(0,o.eW)("mdi-account",-1)])]),_:1}),(0,o.eW)(" "+(0,c.v_)(e.username),1)]),e.class||e.level?((0,o.uX)(),(0,o.CE)("div",H,[e.class?((0,o.uX)(),(0,o.CE)("span",q,(0,c.v_)(e.class),1)):(0,o.Q3)("",!0),e.class&&e.level?((0,o.uX)(),(0,o.CE)("span",G," · ")):(0,o.Q3)("",!0),e.level?((0,o.uX)(),(0,o.CE)("span",Y,"Level "+(0,c.v_)(e.level),1)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}}};const ae=(0,_.A)(ee,[["__scopeId","data-v-b68cd1dc"]]);var te=ae;const le={class:"d-flex justify-space-between align-center my-3"},se={class:"d-flex align-center"},ne={key:0},re={key:1},ue={key:1,class:"text-center pa-4"};var oe={__name:"App",setup(e){const{auth:a,currentUser:t}=b(),l=(0,i.KR)("dkp-table"),s=(0,i.KR)([]),n=(0,i.KR)([]),r=(0,i.KR)([]),u=(0,i.KR)({}),v=(0,i.KR)(!0),m=(0,o.WQ)("db"),p=async()=>{if(m)try{const e=(0,g.KR)(m,"events/"),a=await(0,g.Jt)(e);if(a.exists()){const e=a.val();n.value=e;const t=new Set,l={};Object.values(e).forEach(e=>{const a=e.messageTitle||"Untitled Event";t.add(a)}),Object.values(e).forEach(e=>{const a=e.messageTitle||"Untitled Event";e.usersAttended&&Object.values(e.usersAttended).forEach(e=>{l[e.userId]||(l[e.userId]={}),l[e.userId][a]=(l[e.userId][a]||0)+1})}),r.value=Array.from(t),u.value=l}}catch(e){console.error("Error fetching events:",e)}},f=async()=>{if(m)try{const e=(0,g.KR)(m,"dkp/");return(0,g.Zy)(e,e=>{const a=e.val();if(a){const e=Object.entries(a).map(([e,a])=>{const t={id:e,...a};return r.value.forEach(a=>{t[`event_${a}`]=u.value[e]?.[a]||0}),t});s.value=e.sort((e,a)=>e.user.localeCompare(a.user))}else s.value=[];v.value=!1},e=>{console.error("Database read error:",e),v.value=!1})}catch(e){console.error("Error setting up database listener:",e),v.value=!1}};(0,o.wB)(t,async e=>{e&&(v.value=!0,await p(),await f())}),(0,o.sV)(async()=>{t.value&&(v.value=!0,await p(),await f())});const k=async()=>{try{await(0,d.CI)(a),console.log("User signed out successfully.")}catch(e){console.error("Error signing out:",e.message)}},y=()=>{f()};return(e,a)=>{const d=(0,o.g2)("v-btn"),m=(0,o.g2)("v-tab"),p=(0,o.g2)("v-tabs"),f=(0,o.g2)("v-container"),b=(0,o.g2)("v-app-bar"),g=(0,o.g2)("v-progress-circular"),h=(0,o.g2)("v-main"),_=(0,o.g2)("v-app");return(0,o.uX)(),(0,o.Wv)(_,null,{default:(0,o.k6)(()=>[(0,o.bF)(b,{class:"px-0"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{id:"app-bar",fluid:""},{default:(0,o.k6)(()=>[(0,o.Lk)("div",le,[(0,o.Lk)("div",se,[(0,i.R1)(t)?((0,o.uX)(),(0,o.CE)("span",ne,"Welcome, "+(0,c.v_)((0,i.R1)(t).email),1)):((0,o.uX)(),(0,o.CE)("span",re,"Please sign in"))]),(0,i.R1)(t)?((0,o.uX)(),(0,o.Wv)(d,{key:0,onClick:k,variant:"tonal",class:"sign-out-btn"},{default:(0,o.k6)(()=>[...a[1]||(a[1]=[(0,o.eW)(" Sign Out ",-1)])]),_:1})):(0,o.Q3)("",!0)]),(0,i.R1)(t)?((0,o.uX)(),(0,o.Wv)(p,{key:0,modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),color:"#1f9ee5","align-tabs":"left",class:"mt-8"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{value:"dkp-table",class:"custom-tab"},{default:(0,o.k6)(()=>[...a[2]||(a[2]=[(0,o.eW)("Guild Members",-1)])]),_:1}),(0,o.bF)(m,{value:"parties",class:"custom-tab"},{default:(0,o.k6)(()=>[...a[3]||(a[3]=[(0,o.eW)("Party Manager",-1)])]),_:1})]),_:1},8,["modelValue"])):(0,o.Q3)("",!0)]),_:1})]),_:1}),(0,o.bF)(h,{class:"mt-12"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{id:"main-container"},{default:(0,o.k6)(()=>[(0,i.R1)(t)?v.value?((0,o.uX)(),(0,o.CE)("div",ue,[(0,o.bF)(g,{indeterminate:"",color:"#1f9ee5"}),a[4]||(a[4]=(0,o.Lk)("p",{class:"mt-2",style:{color:"#eaf1ff"}},"Loading data...",-1))])):"dkp-table"===l.value?((0,o.uX)(),(0,o.Wv)(X,{key:2,users:s.value,events:n.value,"event-types":r.value,"attendance-data":u.value,onUserUpdated:y},null,8,["users","events","event-types","attendance-data"])):"parties"===l.value?((0,o.uX)(),(0,o.Wv)(te,{key:3,users:s.value,onUserUpdated:y},null,8,["users"])):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(F,{key:0}))]),_:1})]),_:1})]),_:1})}}};const ie=oe;var ce=ie,de=t(6400);const ve={apiKey:"AIzaSyARl2Ai3AP9JPwKeZ-vustpvsC5RNW-YD4",authDomain:"dkptracker-6121c.firebaseapp.com",databaseURL:"https://dkptracker-6121c-default-rtdb.firebaseio.com",projectId:"dkptracker-6121c",storageBucket:"dkptracker-6121c.firebasestorage.app",messagingSenderId:"1047085462747",appId:"1:1047085462747:web:a5b6e403a81f29420fc8fe"},me=(0,de.Wp)(ve),pe=(0,d.xI)(me),fe=(0,g.C3)(me),be=(0,s.$N)({components:r,directives:u,icons:{defaultSet:"mdi",aliases:n.z,sets:{mdi:n.r}}}),ge=(0,l.Ef)(ce);ge.provide("db",fe),ge.provide("auth",pe),ge.use(be),ge.mount("#app")}},a={};function t(l){var s=a[l];if(void 0!==s)return s.exports;var n=a[l]={exports:{}};return e[l].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(a,l,s,n){if(!l){var r=1/0;for(c=0;c<e.length;c++){l=e[c][0],s=e[c][1],n=e[c][2];for(var u=!0,o=0;o<l.length;o++)(!1&n||r>=n)&&Object.keys(t.O).every(function(e){return t.O[e](l[o])})?l.splice(o--,1):(u=!1,n<r&&(r=n));if(u){e.splice(c--,1);var i=s();void 0!==i&&(a=i)}}return a}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[l,s,n]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var l in a)t.o(a,l)&&!t.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:a[l]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,l){var s,n,r=l[0],u=l[1],o=l[2],i=0;if(r.some(function(a){return 0!==e[a]})){for(s in u)t.o(u,s)&&(t.m[s]=u[s]);if(o)var c=o(t)}for(a&&a(l);i<r.length;i++)n=r[i],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(c)},l=self["webpackChunkdkp_tracker"]=self["webpackChunkdkp_tracker"]||[];l.forEach(a.bind(null,0)),l.push=a.bind(null,l.push.bind(l))}();var l=t.O(void 0,[504],function(){return t(3846)});l=t.O(l)})();
//# sourceMappingURL=app.e26bb570.js.map