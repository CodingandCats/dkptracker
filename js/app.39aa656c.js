(function(){"use strict";var e={3363:function(e,a,l){var t=l(5130),s=l(5753),n=l(6526),r=(l(5524),l(2859)),u=l(3425),i=(l(8111),l(7588),l(1701),l(7642),l(8004),l(3853),l(5876),l(2475),l(5024),l(1698),l(6768)),o=l(144),c=l(4232),d=l(4388);const v=(0,o.KR)(null),m=(0,o.KR)(!1);let p=null;const f=new Promise(e=>{p=e});function k(){const e=(0,i.WQ)("auth");if(!e)throw new Error("Firebase Auth not provided via inject!");return m.value||(0,d.hg)(e,e=>{v.value=e,m.value=!0,p&&p(!0)}),{auth:e,currentUser:v,authInitialized:m,authReady:f}}var b=l(1239);const g={class:"d-flex flex-column gap-3"};function y(e,a,l,s,n,r){const u=(0,i.g2)("v-card-title"),o=(0,i.g2)("v-text-field"),c=(0,i.g2)("v-btn"),d=(0,i.g2)("v-alert"),v=(0,i.g2)("v-form"),m=(0,i.g2)("v-card-text"),p=(0,i.g2)("v-card"),f=(0,i.g2)("v-container");return(0,i.uX)(),(0,i.Wv)(f,{class:"login-container d-flex align-center justify-center"},{default:(0,i.k6)(()=>[(0,i.bF)(p,{class:"login-card pa-8","max-width":"400",width:"100%"},{default:(0,i.k6)(()=>[(0,i.bF)(u,{class:"text-center mb-6"},{default:(0,i.k6)(()=>[...a[3]||(a[3]=[(0,i.Lk)("h2",{class:"login-title"},"The White Order",-1),(0,i.Lk)("div",{class:"login-subtitle"},"DKP Tracker Authentication",-1)])]),_:1}),(0,i.bF)(m,null,{default:(0,i.k6)(()=>[(0,i.bF)(v,{onSubmit:a[2]||(a[2]=(0,t.D$)(()=>{},["prevent"]))},{default:(0,i.k6)(()=>[(0,i.bF)(o,{modelValue:e.email,"onUpdate:modelValue":a[0]||(a[0]=a=>e.email=a),label:"Email",type:"email",variant:"outlined",class:"mb-4 login-field","hide-details":"","prepend-inner-icon":"mdi-email"},null,8,["modelValue"]),(0,i.bF)(o,{modelValue:e.password,"onUpdate:modelValue":a[1]||(a[1]=a=>e.password=a),label:"Password",type:"password",variant:"outlined",class:"mb-6 login-field","hide-details":"","prepend-inner-icon":"mdi-lock"},null,8,["modelValue"]),(0,i.Lk)("div",g,[(0,i.bF)(c,{onClick:e.signIn,color:"#1f9ee5",variant:"elevated",size:"large",block:"",class:"login-btn","prepend-icon":"mdi-login"},{default:(0,i.k6)(()=>[...a[4]||(a[4]=[(0,i.eW)(" Sign In ",-1)])]),_:1},8,["onClick"]),(0,i.bF)(c,{onClick:e.signUp,color:"#1f9ee5",variant:"outlined",size:"large",block:"",class:"signup-btn","prepend-icon":"mdi-account-plus"},{default:(0,i.k6)(()=>[...a[5]||(a[5]=[(0,i.eW)(" Sign Up ",-1)])]),_:1},8,["onClick"])]),e.errorMsg?((0,i.uX)(),(0,i.Wv)(d,{key:0,type:"error",variant:"tonal",class:"mt-4",text:e.errorMsg},null,8,["text"])):(0,i.Q3)("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}var _=(0,i.pM)({name:"LogIn",setup(){const e=(0,o.KR)(""),a=(0,o.KR)(""),l=(0,o.KR)(null),t=(0,i.WQ)("auth"),s=(0,i.WQ)("db");if(!t||!s)return console.error("Firebase Auth or Database not provided!"),l.value="Authentication services not available.",{};const n=async()=>{l.value=null;try{const l=await(0,d.eJ)(t,e.value,a.value),n=l.user,r=n.uid;console.log("User signed up! UID:",r);const u=(0,b.KR)(s,`users/${r}/profile`);await(0,b.hZ)(u,{email:n.email,createdAt:(new Date).toISOString()}),console.log("User profile created in RTDB.")}catch(n){console.error("Error signing up:",n.message),l.value=n.message}},r=async()=>{l.value=null;try{await(0,d.x9)(t,e.value,a.value),console.log("User signed in!")}catch(s){console.error("Error signing in:",s.message),l.value=s.message}};return{email:e,password:a,signUp:n,signIn:r,errorMsg:l}}}),h=l(1241);const F=(0,h.A)(_,[["render",y],["__scopeId","data-v-49ad6c2a"]]);var x=F;l(4114),l(3579);const w={class:"text-subtitle-2 mb-2"};var C={__name:"DkpModal",props:{modelValue:{type:Boolean,required:!0},item:{type:Object,default:null}},emits:["update:modelValue","saved"],setup(e,{emit:a}){const l=e,t=a,s=(0,i.EW)({get:()=>l.modelValue,set:e=>t("update:modelValue",e)}),n=e=>{t("update:modelValue",e)},r=(0,i.WQ)("db"),u=(0,o.KR)(0),d=(0,o.KR)(""),v=(0,o.KR)(""),m=(0,o.KR)(""),p=(0,o.KR)(0),f=(0,o.KR)({}),k=["Field Raids","Epics","Clan Hall/Fort","Call To Arms","Siege"],g=async()=>{if(l.item&&r)try{const e=(0,b.KR)(r,"events/"),a=await(0,b.Jt)(e);if(a.exists()){const e=a.val();let t=0;const s={};k.forEach(e=>{s[e]=0}),Object.values(e).forEach(e=>{if(console.log("Event:",e.messageTitle,"UsersAttended:",e.usersAttended),e.usersAttended){const a=e.messageTitle||"Untitled Event";if(console.log("Event title:",a,"Is in display list:",k.includes(a)),!k.includes(a))return;const n=Object.values(e.usersAttended).some(e=>(console.log("Checking user:",e,"against item:",l.item),e.userId===l.item.id||e.userId===l.item.user||e.username===l.item.user||e.username===l.item.id));n&&(s[a]=(s[a]||0)+1,t++,console.log("User attended event:",a,"New count:",s[a]))}}),console.log("Final attendance by type:",s),console.log("Total attendance:",t),p.value=t,f.value=s}}catch(e){console.error("Error fetching attendance:",e)}};(0,i.wB)(()=>l.item,async e=>{e&&(u.value=e.dkp||0,d.value=e.user||"",v.value=e.class||"",m.value=e.level||"",await g())},{immediate:!0});const y=async()=>{if(l.item&&r&&d.value)try{const e=l.item.isNew?d.value:l.item.id,a=(0,b.KR)(r,`dkp/${e}`);await(0,b.hZ)(a,{user:d.value,dkp:Number(u.value),class:v.value||"",level:m.value||""}),t("update:modelValue",!1),t("saved")}catch(e){console.error("Error saving user:",e)}};return(a,l)=>{const t=(0,i.g2)("v-card-title"),r=(0,i.g2)("v-text-field"),o=(0,i.g2)("v-col"),k=(0,i.g2)("v-list-subheader"),b=(0,i.g2)("v-table"),g=(0,i.g2)("v-row"),_=(0,i.g2)("v-container"),h=(0,i.g2)("v-card-text"),F=(0,i.g2)("v-spacer"),x=(0,i.g2)("v-btn"),C=(0,i.g2)("v-card-actions"),E=(0,i.g2)("v-card"),L=(0,i.g2)("v-dialog");return(0,i.uX)(),(0,i.Wv)(L,{"model-value":s.value,"onUpdate:modelValue":n,"max-width":"500px"},{default:(0,i.k6)(()=>[(0,i.bF)(E,null,{default:(0,i.k6)(()=>[(0,i.bF)(t,{class:"text-h5"},{default:(0,i.k6)(()=>[(0,i.Lk)("span",null,(0,c.v_)(e.item?.isNew?"Add New User":`${e.item?.user} Details`),1)]),_:1}),(0,i.bF)(h,null,{default:(0,i.k6)(()=>[(0,i.bF)(_,null,{default:(0,i.k6)(()=>[(0,i.bF)(g,{justify:"center"},{default:(0,i.k6)(()=>[(0,i.bF)(o,{cols:"12"},{default:(0,i.k6)(()=>[e.item?((0,i.uX)(),(0,i.Wv)(r,{key:0,modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=e=>d.value=e),label:"Username",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,i.Q3)("",!0),e.item?((0,i.uX)(),(0,i.Wv)(r,{key:1,modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=e=>u.value=e),modelModifiers:{number:!0},label:"DKP",type:"number",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,i.Q3)("",!0),e.item?((0,i.uX)(),(0,i.Wv)(r,{key:2,modelValue:v.value,"onUpdate:modelValue":l[2]||(l[2]=e=>v.value=e),label:"Class",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,i.Q3)("",!0),e.item?((0,i.uX)(),(0,i.Wv)(r,{key:3,modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=e=>m.value=e),label:"Level",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,i.Q3)("",!0),(0,i.Lk)("div",w," Total Event Attendance: "+(0,c.v_)(p.value),1)]),_:1}),(0,i.bF)(o,{cols:"12",class:"attendance-list pa-4"},{default:(0,i.k6)(()=>[(0,i.bF)(k,null,{default:(0,i.k6)(()=>[...l[5]||(l[5]=[(0,i.eW)("Attendance by Event Type:",-1)])]),_:1}),(0,i.bF)(b,{dense:""},{header:(0,i.k6)(()=>[...l[6]||(l[6]=[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"Event Type"),(0,i.Lk)("th",null,"Attendance Count")],-1)])]),default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(f.value,(e,a)=>((0,i.uX)(),(0,i.CE)("tr",{key:a},[(0,i.Lk)("td",null,(0,c.v_)(a),1),(0,i.Lk)("td",null,(0,c.v_)(e),1)]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),(0,i.bF)(C,null,{default:(0,i.k6)(()=>[(0,i.bF)(F),(0,i.bF)(x,{color:"primary",variant:"text",onClick:l[4]||(l[4]=e=>n(!1))},{default:(0,i.k6)(()=>[...l[7]||(l[7]=[(0,i.eW)(" Cancel ",-1)])]),_:1}),(0,i.bF)(x,{color:"primary",variant:"text",onClick:y},{default:(0,i.k6)(()=>[...l[8]||(l[8]=[(0,i.eW)(" Save ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const E=(0,h.A)(C,[["__scopeId","data-v-040d4274"]]);var L=E;const W={class:"search-container"},R={class:"d-flex align-center justify-start"},X={class:"text-center"},K={class:"text-center"},V=["colspan"],U={class:"d-flex justify-space-between align-center mb-3"},A={class:"mobile-expanded-title"},I={class:"mb-3"},j={class:"d-flex align-center mb-2"},Q={class:"mobile-value"},O={class:"mb-3"},P={class:"d-flex align-center mb-2"},D={class:"pl-6"},S={class:"mobile-event-name"},z={class:"mobile-event-count"};var T={__name:"DkpTable",props:{users:{type:Array,default:()=>[]},events:{type:Object,default:()=>({})},eventTypes:{type:Array,default:()=>[]},attendanceData:{type:Object,default:()=>({})}},emits:["user-updated"],setup(e,{emit:a}){const l=a,t=(0,o.KR)(""),s=(0,o.KR)(!1),n=(0,o.KR)(null),r=(0,o.KR)(!1),u=(0,o.KR)([]),d=()=>{r.value=window.innerWidth<768};(0,i.sV)(()=>{d(),window.addEventListener("resize",d)}),(0,i.hi)(()=>{window.removeEventListener("resize",d)});const v=e=>{n.value=e,s.value=!0},m=["Field Raids","Epics","Clan Hall/Fort","Call To Arms","Siege"],p=(0,i.EW)(()=>{const e=[{align:"start",key:"user",sortable:!0,title:"User Name",width:r.value?"40%":"150px"},{key:"class",align:"center",title:"Class",sortable:!0,width:r.value?"30%":"120px"},{key:"level",align:"center",title:"Level",sortable:!0,width:r.value?"30%":"80px"}];if(r.value)return[...e,{key:"data-table-expand",align:"center",title:"",width:"48px",sortable:!1}];e.push({key:"dkp",align:"center",title:"DKP",width:"100px",sortable:!0});const a=m.map(e=>({key:`event_${e}`,align:"center",title:e,sortable:!0,width:"100px"}));return[...e,...a,{key:"actions",align:"center",title:"Actions",width:"80px"}]}),f=()=>{l("user-updated")};return(a,l)=>{const o=(0,i.g2)("v-icon"),d=(0,i.g2)("v-text-field"),k=(0,i.g2)("v-btn"),b=(0,i.g2)("v-card-text"),g=(0,i.g2)("v-card"),y=(0,i.g2)("v-data-table");return(0,i.uX)(),(0,i.Wv)(g,{class:"pa-4",id:"card-container"},{title:(0,i.k6)(()=>[...l[3]||(l[3]=[(0,i.Lk)("div",{class:"d-flex py-2"},[(0,i.Lk)("h2",{class:"text-h4 font-weight-bold page-title"}," The White Order Lineage 2 Players ")],-1),(0,i.Lk)("hr",null,null,-1)])]),text:(0,i.k6)(()=>[(0,i.Lk)("div",W,[(0,i.bF)(d,{modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),label:"Search",variant:"underlined","hide-details":"","single-line":"",class:"search-field"},{"prepend-inner":(0,i.k6)(()=>[(0,i.bF)(o,{color:"#1f9ee5"},{default:(0,i.k6)(()=>[...l[4]||(l[4]=[(0,i.eW)("mdi-magnify",-1)])]),_:1})]),_:1},8,["modelValue"])])]),default:(0,i.k6)(()=>[(0,i.bF)(y,{hover:"",headers:p.value,items:e.users,search:t.value,"fixed-header":"",class:"table-container",density:"comfortable","show-expand":r.value,expanded:u.value,"onUpdate:expanded":l[1]||(l[1]=e=>u.value=e),"items-per-page":"1000","hide-default-footer":""},(0,i.eX)({["item.user"]:(0,i.k6)(({item:e})=>[(0,i.Lk)("div",R,[(0,i.bF)(o,{color:"#1f9ee5",class:"me-2"},{default:(0,i.k6)(()=>[...l[5]||(l[5]=[(0,i.eW)("mdi-account",-1)])]),_:1}),(0,i.eW)(" "+(0,c.v_)(e.user),1)])]),["item.class"]:(0,i.k6)(({item:e})=>[(0,i.Lk)("div",X,(0,c.v_)(e.class||"-"),1)]),["item.level"]:(0,i.k6)(({item:e})=>[(0,i.Lk)("div",K,(0,c.v_)(e.level||"-"),1)]),"expanded-row":(0,i.k6)(({columns:e,item:a})=>[(0,i.Lk)("tr",null,[(0,i.Lk)("td",{colspan:e.length,class:"pa-4"},[(0,i.bF)(g,{class:"mobile-expanded-card",flat:""},{default:(0,i.k6)(()=>[(0,i.bF)(b,{class:"pa-3"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",U,[(0,i.Lk)("h4",A,(0,c.v_)(a.user)+" Details",1),(0,i.bF)(k,{size:"small",icon:"",variant:"text",color:"#1f9ee5",onClick:e=>v(a)},{default:(0,i.k6)(()=>[(0,i.bF)(o,null,{default:(0,i.k6)(()=>[...l[7]||(l[7]=[(0,i.eW)("mdi-pencil",-1)])]),_:1})]),_:1},8,["onClick"])]),(0,i.Lk)("div",I,[(0,i.Lk)("div",j,[(0,i.bF)(o,{color:"#1f9ee5",class:"me-2",size:"small"},{default:(0,i.k6)(()=>[...l[8]||(l[8]=[(0,i.eW)("mdi-star",-1)])]),_:1}),l[9]||(l[9]=(0,i.Lk)("span",{class:"mobile-label"},"DKP:",-1)),(0,i.Lk)("span",Q,(0,c.v_)(a.dkp||0),1)])]),(0,i.Lk)("div",O,[(0,i.Lk)("div",P,[(0,i.bF)(o,{color:"#1f9ee5",class:"me-2",size:"small"},{default:(0,i.k6)(()=>[...l[10]||(l[10]=[(0,i.eW)("mdi-calendar",-1)])]),_:1}),l[11]||(l[11]=(0,i.Lk)("span",{class:"mobile-label"},"Event Attendance:",-1))]),(0,i.Lk)("div",D,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(m,e=>(0,i.Lk)("div",{key:e,class:"d-flex justify-space-between mb-1"},[(0,i.Lk)("span",S,(0,c.v_)(e)+":",1),(0,i.Lk)("span",z,(0,c.v_)(a[`event_${e}`]||0),1)])),64))])])]),_:2},1024)]),_:2},1024)],8,V)])]),_:2},[r.value?void 0:{name:"item.actions",fn:(0,i.k6)(({item:e})=>[(0,i.bF)(k,{size:"small",icon:"",variant:"text",color:"#1f9ee5",onClick:a=>v(e)},{default:(0,i.k6)(()=>[(0,i.bF)(o,null,{default:(0,i.k6)(()=>[...l[6]||(l[6]=[(0,i.eW)("mdi-pencil",-1)])]),_:1})]),_:1},8,["onClick"])]),key:"0"}]),1032,["headers","items","search","show-expand","expanded"]),(0,i.bF)(L,{modelValue:s.value,"onUpdate:modelValue":l[2]||(l[2]=e=>s.value=e),item:n.value,onSaved:f},null,8,["modelValue","item"])]),_:1})}}};const $=(0,h.A)(T,[["__scopeId","data-v-54f3ed64"]]);var M=$,N=(l(116),l(1527)),J=l.n(N);const B={class:"d-flex justify-space-between align-center py-2 header-container"},Z={class:"d-flex align-center gap-4 button-group"},H={class:"d-flex flex-column"},q={class:"d-flex align-center"},G={key:0,class:"user-details"},Y={key:0},ee={key:1},ae={key:2},le={key:1,class:"user-pool-mobile"},te={class:"d-flex align-center"},se={class:"user-name"},ne={key:0,class:"user-details"},re={key:0},ue={key:1},ie={key:2},oe={key:0,class:"empty-state"},ce={class:"d-flex align-center justify-space-between w-100"},de={class:"d-flex align-center"},ve={class:"party-count me-2"},me={class:"d-flex flex-column"},pe={class:"d-flex align-center"},fe={key:0,class:"user-details"},ke={key:0},be={key:1},ge={key:2},ye={key:1,class:"party-drop-zone-mobile"},_e={class:"d-flex align-center"},he={class:"user-name"},Fe={key:0,class:"user-details"},xe={key:0},we={key:1},Ce={key:2},Ee={key:0,class:"empty-state"},Le={class:"current-location mb-3"};var We={__name:"PartyManager",props:{users:{type:Array,default:()=>[]}},setup(e){const a=e,l=(0,i.WQ)("db"),s=(0,o.KR)(!1),n=(0,o.KR)([]),r=(0,o.KR)([{id:1,name:"Party 1",members:[]},{id:2,name:"Party 2",members:[]},{id:3,name:"Party 3",members:[]},{id:4,name:"Party 4",members:[]}]),u=(0,o.KR)(!1),d=(0,o.KR)(!1),v=(0,o.KR)(null),m=(0,o.KR)(null),p=(0,o.KR)([]),f=async e=>{if(l)try{const a=(0,b.KR)(l,"parties"),t=(0,b.P)(a,(0,b.JK)(),(0,b.$1)(1)),s=await(0,b.Jt)(t);if(s.exists()){const a=s.val(),l=Object.values(a)[0];console.log("Loading saved party configuration:",l);const t=new Map;l.unassignedUsers?.forEach(e=>{t.set(e.username,{...e,assignment:"unassigned"})}),l.parties?.forEach(e=>{e.members?.forEach(a=>{t.set(a.username,{...a,assignment:e.id})})}),l.parties&&l.parties.length>0&&(r.value=l.parties.map(e=>({id:e.id,name:e.name||`Party ${e.id}`,members:[]})));const u=[],i={};r.value.forEach(e=>{i[e.id]=[]}),e.forEach(e=>{const a=t.get(e.username);a&&"unassigned"!==a.assignment&&i[a.assignment]?i[a.assignment].push(e):u.push(e)}),n.value=u,r.value.forEach(e=>{e.members=i[e.id]||[]}),console.log("Party configuration loaded successfully")}else console.log("No saved party configuration found, using default"),n.value=e}catch(a){console.error("Error loading party configuration:",a),n.value=e}else n.value=e},k=async()=>{const e=a.users.map(e=>({username:e.user,class:e.class||"",level:e.level||""})).sort((e,a)=>e.username.localeCompare(a.username));await f(e)};(0,i.wB)(()=>a.users,async()=>{await k()},{immediate:!0}),(0,i.sV)(async()=>{a.users.length>0&&await k()});const g=()=>{const e=Math.max(...r.value.map(e=>e.id))+1;r.value.push({id:e,name:`Party ${e}`,members:[]})},y=e=>{const a=r.value[e];n.value.push(...a.members),r.value.splice(e,1),console.log(`Party "${a.name}" deleted locally. Click Save to persist changes.`)},_=async()=>{if(l)try{const e=(0,b.KR)(l,"parties"),a=await(0,b.Jt)(e);if(a.exists()){const e=a.val(),t=new Date;t.setDate(t.getDate()-14);const s=[];Object.keys(e).forEach(a=>{const l=e[a];if(l.timestamp){const e=new Date(l.timestamp);e<t&&s.push(a)}});for(const a of s){const e=(0,b.KR)(l,`parties/${a}`);await(0,b.TF)(e)}s.length>0&&console.log(`Cleaned up ${s.length} old party entries`)}}catch(e){console.error("Error cleaning up old party entries:",e)}else console.error("Database not available for cleanup")},h=async()=>{if(l){s.value=!0;try{const e=new Date,a=e.toISOString(),t=a.replace(/[.#$[\]]/g,"_"),s={timestamp:a,unassignedUsers:n.value,parties:r.value.map(e=>({id:e.id,name:e.name,members:e.members,memberCount:e.members.length}))},u=(0,b.KR)(l,`parties/${t}`);await(0,b.hZ)(u,s),await _(),console.log("Parties saved successfully!",s)}catch(e){console.error("Error saving parties:",e)}finally{s.value=!1}}else console.error("Database not available")},F=()=>{u.value=window.innerWidth<768},x=(e,a)=>{v.value=e,m.value=a,p.value=[{title:"Available Users",value:"unassigned"},...r.value.map(e=>({title:e.name,value:e.id}))],d.value=!0},w=()=>{if("unassigned"===m.value)return"Available Users";const e=r.value.find(e=>e.id===m.value);return e?e.name:"Unknown"},C=e=>{if(!v.value||e===m.value)return void(d.value=!1);const a=v.value;if(E(a),"unassigned"===e)n.value.push(a);else{const l=r.value.find(a=>a.id===e);l&&l.members.push(a)}d.value=!1,v.value=null,m.value=null},E=e=>{const a=n.value.findIndex(a=>a.username===e.username);a>-1?n.value.splice(a,1):r.value.forEach(a=>{const l=a.members.findIndex(a=>a.username===e.username);l>-1&&a.members.splice(l,1)})};return(0,i.sV)(()=>{F(),window.addEventListener("resize",F)}),(0,i.hi)(()=>{window.removeEventListener("resize",F)}),(e,a)=>{const l=(0,i.g2)("v-btn"),f=(0,i.g2)("v-col"),k=(0,i.g2)("v-row"),b=(0,i.g2)("v-card-title"),_=(0,i.g2)("v-icon"),F=(0,i.g2)("v-card-text"),E=(0,i.g2)("v-card"),L=(0,i.g2)("v-text-field"),W=(0,i.g2)("v-chip"),R=(0,i.g2)("v-list-item-title"),X=(0,i.g2)("v-list-item"),K=(0,i.g2)("v-list"),V=(0,i.g2)("v-dialog"),U=(0,i.g2)("v-container");return(0,i.uX)(),(0,i.Wv)(U,{fluid:"",class:"pa-0"},{default:(0,i.k6)(()=>[(0,i.bF)(k,null,{default:(0,i.k6)(()=>[(0,i.bF)(f,{cols:"12"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",B,[a[6]||(a[6]=(0,i.Lk)("h2",{class:"text-h4 font-weight-bold page-title"},"Party Members",-1)),(0,i.Lk)("div",Z,[(0,i.bF)(l,{onClick:g,variant:"tonal",color:"#1f9ee5","prepend-icon":"mdi-plus"},{default:(0,i.k6)(()=>[...a[4]||(a[4]=[(0,i.eW)(" Add Party ",-1)])]),_:1}),(0,i.bF)(l,{onClick:h,variant:"tonal",color:"success","prepend-icon":"mdi-content-save",loading:s.value,class:"mx-4"},{default:(0,i.k6)(()=>[...a[5]||(a[5]=[(0,i.eW)(" Save Parties ",-1)])]),_:1},8,["loading"])])]),a[7]||(a[7]=(0,i.Lk)("hr",null,null,-1))]),_:1})]),_:1}),(0,i.bF)(k,null,{default:(0,i.k6)(()=>[(0,i.bF)(f,{cols:"12",md:"12",lg:"3"},{default:(0,i.k6)(()=>[(0,i.bF)(E,{class:"party-card",id:"user-pool-card"},{default:(0,i.k6)(()=>[(0,i.bF)(b,{class:"text-center"},{default:(0,i.k6)(()=>[...a[8]||(a[8]=[(0,i.eW)("Available Users",-1)])]),_:1}),(0,i.bF)(F,null,{default:(0,i.k6)(()=>[u.value?((0,i.uX)(),(0,i.CE)("div",le,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.value,e=>((0,i.uX)(),(0,i.Wv)(E,{key:e.username,class:"user-card mb-2"},{default:(0,i.k6)(()=>[(0,i.bF)(F,{class:"d-flex align-center justify-space-between"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",te,[(0,i.bF)(_,{color:"#1f9ee5",class:"me-2"},{default:(0,i.k6)(()=>[...a[10]||(a[10]=[(0,i.eW)("mdi-account",-1)])]),_:1}),(0,i.Lk)("div",null,[(0,i.Lk)("div",se,(0,c.v_)(e.username),1),e.class||e.level?((0,i.uX)(),(0,i.CE)("div",ne,[e.class?((0,i.uX)(),(0,i.CE)("span",re,(0,c.v_)(e.class),1)):(0,i.Q3)("",!0),e.class&&e.level?((0,i.uX)(),(0,i.CE)("span",ue," · ")):(0,i.Q3)("",!0),e.level?((0,i.uX)(),(0,i.CE)("span",ie,"Level "+(0,c.v_)(e.level),1)):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])]),(0,i.bF)(l,{icon:"",size:"small",color:"#1f9ee5",variant:"outlined",onClick:a=>x(e,"unassigned")},{default:(0,i.k6)(()=>[(0,i.bF)(_,null,{default:(0,i.k6)(()=>[...a[11]||(a[11]=[(0,i.eW)("mdi-arrow-right",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),0===n.value.length?((0,i.uX)(),(0,i.CE)("div",oe,[(0,i.bF)(_,{color:"#1f9ee5",size:"48"},{default:(0,i.k6)(()=>[...a[12]||(a[12]=[(0,i.eW)("mdi-account-group",-1)])]),_:1}),a[13]||(a[13]=(0,i.Lk)("p",{class:"text-center mt-2"},"No available users",-1))])):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.Wv)((0,o.R1)(J()),{key:0,modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),group:"users","item-key":"username",class:"user-pool"},{item:(0,i.k6)(({element:e})=>[(0,i.bF)(E,{class:"user-card mb-2"},{default:(0,i.k6)(()=>[(0,i.bF)(F,{class:"d-flex align-center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",H,[(0,i.Lk)("div",q,[(0,i.bF)(_,{color:"#1f9ee5",class:"me-2"},{default:(0,i.k6)(()=>[...a[9]||(a[9]=[(0,i.eW)("mdi-account",-1)])]),_:1}),(0,i.eW)(" "+(0,c.v_)(e.username),1)]),e.class||e.level?((0,i.uX)(),(0,i.CE)("div",G,[e.class?((0,i.uX)(),(0,i.CE)("span",Y,(0,c.v_)(e.class),1)):(0,i.Q3)("",!0),e.class&&e.level?((0,i.uX)(),(0,i.CE)("span",ee," · ")):(0,i.Q3)("",!0),e.level?((0,i.uX)(),(0,i.CE)("span",ae,"Level "+(0,c.v_)(e.level),1)):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),_:1}),(0,i.bF)(f,{cols:"12",md:"12",lg:"9"},{default:(0,i.k6)(()=>[(0,i.bF)(k,{style:{width:"100%"}},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.value,(e,s)=>((0,i.uX)(),(0,i.Wv)(f,{key:s,cols:"12",sm:"6",lg:"4"},{default:(0,i.k6)(()=>[(0,i.bF)(E,{class:"party-card"},{default:(0,i.k6)(()=>[(0,i.bF)(b,{class:"text-center party-title-container"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",ce,[(0,i.bF)(L,{modelValue:e.name,"onUpdate:modelValue":a=>e.name=a,variant:"plain",class:"party-name-field","hide-details":"",density:"compact",onClick:a[1]||(a[1]=(0,t.D$)(()=>{},["stop"]))},null,8,["modelValue","onUpdate:modelValue"]),(0,i.Lk)("div",de,[(0,i.Lk)("span",ve,"("+(0,c.v_)(e.members.length)+")",1),(0,i.bF)(l,{icon:"",size:"small",variant:"text",color:"error",onClick:e=>y(s)},{default:(0,i.k6)(()=>[(0,i.bF)(_,{size:"medium"},{default:(0,i.k6)(()=>[...a[14]||(a[14]=[(0,i.eW)("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])])])]),_:2},1024),(0,i.bF)(F,null,{default:(0,i.k6)(()=>[u.value?((0,i.uX)(),(0,i.CE)("div",ye,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.members,t=>((0,i.uX)(),(0,i.Wv)(E,{key:t.username,class:"user-card mb-1"},{default:(0,i.k6)(()=>[(0,i.bF)(F,{class:"d-flex align-center justify-space-between"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",_e,[(0,i.bF)(_,{color:"#1f9ee5",class:"me-2"},{default:(0,i.k6)(()=>[...a[16]||(a[16]=[(0,i.eW)("mdi-account",-1)])]),_:1}),(0,i.Lk)("div",null,[(0,i.Lk)("div",he,(0,c.v_)(t.username),1),t.class||t.level?((0,i.uX)(),(0,i.CE)("div",Fe,[t.class?((0,i.uX)(),(0,i.CE)("span",xe,(0,c.v_)(t.class),1)):(0,i.Q3)("",!0),t.class&&t.level?((0,i.uX)(),(0,i.CE)("span",we," · ")):(0,i.Q3)("",!0),t.level?((0,i.uX)(),(0,i.CE)("span",Ce,"Level "+(0,c.v_)(t.level),1)):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])]),(0,i.bF)(l,{icon:"",size:"small",color:"#1f9ee5",variant:"outlined",onClick:a=>x(t,e.id)},{default:(0,i.k6)(()=>[(0,i.bF)(_,null,{default:(0,i.k6)(()=>[...a[17]||(a[17]=[(0,i.eW)("mdi-arrow-right",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),0===e.members.length?((0,i.uX)(),(0,i.CE)("div",Ee,[(0,i.bF)(_,{color:"#1f9ee5",size:"48"},{default:(0,i.k6)(()=>[...a[18]||(a[18]=[(0,i.eW)("mdi-account-plus",-1)])]),_:1}),a[19]||(a[19]=(0,i.Lk)("p",{class:"text-center mt-2"},"No party members",-1))])):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.Wv)((0,o.R1)(J()),{key:0,modelValue:e.members,"onUpdate:modelValue":a=>e.members=a,group:"users","item-key":"username",class:"party-drop-zone"},{item:(0,i.k6)(({element:e})=>[(0,i.bF)(E,{class:"user-card mb-1"},{default:(0,i.k6)(()=>[(0,i.bF)(F,{class:"d-flex align-center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",me,[(0,i.Lk)("div",pe,[(0,i.bF)(_,{color:"#1f9ee5",class:"me-2"},{default:(0,i.k6)(()=>[...a[15]||(a[15]=[(0,i.eW)("mdi-account",-1)])]),_:1}),(0,i.eW)(" "+(0,c.v_)(e.username),1)]),e.class||e.level?((0,i.uX)(),(0,i.CE)("div",fe,[e.class?((0,i.uX)(),(0,i.CE)("span",ke,(0,c.v_)(e.class),1)):(0,i.Q3)("",!0),e.class&&e.level?((0,i.uX)(),(0,i.CE)("span",be," · ")):(0,i.Q3)("",!0),e.level?((0,i.uX)(),(0,i.CE)("span",ge,"Level "+(0,c.v_)(e.level),1)):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),(0,i.bF)(V,{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=e=>d.value=e),"max-width":"400px"},{default:(0,i.k6)(()=>[(0,i.bF)(E,{class:"mobile-move-dialog",theme:"dark"},{default:(0,i.k6)(()=>[(0,i.bF)(b,{class:"d-flex justify-space-between align-center"},{default:(0,i.k6)(()=>[(0,i.Lk)("span",null,"Move "+(0,c.v_)(v.value?.username),1),(0,i.bF)(l,{icon:"mdi-close",variant:"text",onClick:a[2]||(a[2]=e=>d.value=!1)})]),_:1}),(0,i.bF)(F,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",Le,[(0,i.bF)(W,{color:"#1f9ee5",variant:"outlined",size:"small"},{default:(0,i.k6)(()=>[(0,i.eW)(" Currently in: "+(0,c.v_)(w()),1)]),_:1})]),(0,i.bF)(K,null,{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.value,e=>((0,i.uX)(),(0,i.Wv)(X,{key:e.value,onClick:a=>C(e.value),class:(0,c.C4)(["move-option",{"current-location-option":e.value===m.value}])},(0,i.eX)({prepend:(0,i.k6)(()=>[(0,i.bF)(_,{color:"#1f9ee5"},{default:(0,i.k6)(()=>[(0,i.eW)((0,c.v_)("unassigned"===e.value?"mdi-account-group":"mdi-account-multiple"),1)]),_:2},1024)]),default:(0,i.k6)(()=>[(0,i.bF)(R,null,{default:(0,i.k6)(()=>[(0,i.eW)((0,c.v_)(e.title),1)]),_:2},1024)]),_:2},[e.value===m.value?{name:"append",fn:(0,i.k6)(()=>[(0,i.bF)(W,{size:"x-small",color:"success"},{default:(0,i.k6)(()=>[...a[20]||(a[20]=[(0,i.eW)("Current",-1)])]),_:1})]),key:"0"}:void 0]),1032,["onClick","class"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};const Re=(0,h.A)(We,[["__scopeId","data-v-5278ad78"]]);var Xe=Re;const Ke={class:"d-flex justify-space-between align-center my-3"},Ve={class:"d-flex align-center"},Ue={key:0},Ae={key:1},Ie={key:1,class:"text-center pa-4"};var je={__name:"App",setup(e){const{auth:a,currentUser:l}=k(),t=(0,o.KR)("dkp-table"),s=(0,o.KR)([]),n=(0,o.KR)([]),r=(0,o.KR)([]),u=(0,o.KR)({}),v=(0,o.KR)(!0),m=(0,i.WQ)("db"),p=async()=>{if(m)try{const e=(0,b.KR)(m,"events/"),a=await(0,b.Jt)(e);if(a.exists()){const e=a.val();n.value=e;const l=new Set,t={};Object.values(e).forEach(e=>{const a=e.messageTitle||"Untitled Event";l.add(a)}),Object.values(e).forEach(e=>{const a=e.messageTitle||"Untitled Event";e.usersAttended&&Object.values(e.usersAttended).forEach(e=>{t[e.userId]||(t[e.userId]={}),t[e.userId][a]=(t[e.userId][a]||0)+1})}),r.value=Array.from(l),u.value=t}}catch(e){console.error("Error fetching events:",e)}},f=async()=>{if(m)try{const e=(0,b.KR)(m,"dkp/");return(0,b.Zy)(e,e=>{const a=e.val();if(a){const e=Object.entries(a).map(([e,a])=>{const l={id:e,...a};return r.value.forEach(a=>{l[`event_${a}`]=u.value[e]?.[a]||0}),l});s.value=e.sort((e,a)=>e.user.localeCompare(a.user))}else s.value=[];v.value=!1},e=>{console.error("Database read error:",e),v.value=!1})}catch(e){console.error("Error setting up database listener:",e),v.value=!1}};(0,i.wB)(l,async e=>{e&&(v.value=!0,await p(),await f())}),(0,i.sV)(async()=>{l.value&&(v.value=!0,await p(),await f())});const g=async()=>{try{await(0,d.CI)(a),console.log("User signed out successfully.")}catch(e){console.error("Error signing out:",e.message)}},y=()=>{f()};return(e,a)=>{const d=(0,i.g2)("v-btn"),m=(0,i.g2)("v-tab"),p=(0,i.g2)("v-tabs"),f=(0,i.g2)("v-container"),k=(0,i.g2)("v-app-bar"),b=(0,i.g2)("v-progress-circular"),_=(0,i.g2)("v-main"),h=(0,i.g2)("v-app");return(0,i.uX)(),(0,i.Wv)(h,null,{default:(0,i.k6)(()=>[(0,i.bF)(k,{class:"px-0"},{default:(0,i.k6)(()=>[(0,i.bF)(f,{id:"app-bar",fluid:""},{default:(0,i.k6)(()=>[(0,i.Lk)("div",Ke,[(0,i.Lk)("div",Ve,[(0,o.R1)(l)?((0,i.uX)(),(0,i.CE)("span",Ue,"Welcome, "+(0,c.v_)((0,o.R1)(l).email),1)):((0,i.uX)(),(0,i.CE)("span",Ae,"Please sign in"))]),(0,o.R1)(l)?((0,i.uX)(),(0,i.Wv)(d,{key:0,onClick:g,variant:"tonal",class:"sign-out-btn"},{default:(0,i.k6)(()=>[...a[1]||(a[1]=[(0,i.eW)(" Sign Out ",-1)])]),_:1})):(0,i.Q3)("",!0)]),(0,o.R1)(l)?((0,i.uX)(),(0,i.Wv)(p,{key:0,modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),color:"#1f9ee5","align-tabs":"left",class:"mt-8"},{default:(0,i.k6)(()=>[(0,i.bF)(m,{value:"dkp-table",class:"custom-tab"},{default:(0,i.k6)(()=>[...a[2]||(a[2]=[(0,i.eW)("Guild Members",-1)])]),_:1}),(0,i.bF)(m,{value:"parties",class:"custom-tab"},{default:(0,i.k6)(()=>[...a[3]||(a[3]=[(0,i.eW)("Party Manager",-1)])]),_:1})]),_:1},8,["modelValue"])):(0,i.Q3)("",!0)]),_:1})]),_:1}),(0,i.bF)(_,{class:"mt-12"},{default:(0,i.k6)(()=>[(0,i.bF)(f,{id:"main-container"},{default:(0,i.k6)(()=>[(0,o.R1)(l)?v.value?((0,i.uX)(),(0,i.CE)("div",Ie,[(0,i.bF)(b,{indeterminate:"",color:"#1f9ee5"}),a[4]||(a[4]=(0,i.Lk)("p",{class:"mt-2",style:{color:"#eaf1ff"}},"Loading data...",-1))])):"dkp-table"===t.value?((0,i.uX)(),(0,i.Wv)(M,{key:2,users:s.value,events:n.value,"event-types":r.value,"attendance-data":u.value,onUserUpdated:y},null,8,["users","events","event-types","attendance-data"])):"parties"===t.value?((0,i.uX)(),(0,i.Wv)(Xe,{key:3,users:s.value,onUserUpdated:y},null,8,["users"])):(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(x,{key:0}))]),_:1})]),_:1})]),_:1})}}};const Qe=je;var Oe=Qe,Pe=l(6400);const De={apiKey:"AIzaSyARl2Ai3AP9JPwKeZ-vustpvsC5RNW-YD4",authDomain:"dkptracker-6121c.firebaseapp.com",databaseURL:"https://dkptracker-6121c-default-rtdb.firebaseio.com",projectId:"dkptracker-6121c",storageBucket:"dkptracker-6121c.firebasestorage.app",messagingSenderId:"1047085462747",appId:"1:1047085462747:web:a5b6e403a81f29420fc8fe"},Se=(0,Pe.Wp)(De),ze=(0,d.xI)(Se),Te=(0,b.C3)(Se),$e=(0,s.$N)({components:r,directives:u,icons:{defaultSet:"mdi",aliases:n.z,sets:{mdi:n.r}}}),Me=(0,t.Ef)(Oe);Me.provide("db",Te),Me.provide("auth",ze),Me.use($e),Me.mount("#app")}},a={};function l(t){var s=a[t];if(void 0!==s)return s.exports;var n=a[t]={exports:{}};return e[t].call(n.exports,n,n.exports,l),n.exports}l.m=e,function(){var e=[];l.O=function(a,t,s,n){if(!t){var r=1/0;for(c=0;c<e.length;c++){t=e[c][0],s=e[c][1],n=e[c][2];for(var u=!0,i=0;i<t.length;i++)(!1&n||r>=n)&&Object.keys(l.O).every(function(e){return l.O[e](t[i])})?t.splice(i--,1):(u=!1,n<r&&(r=n));if(u){e.splice(c--,1);var o=s();void 0!==o&&(a=o)}}return a}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[t,s,n]}}(),function(){l.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(a,{a:a}),a}}(),function(){l.d=function(e,a){for(var t in a)l.o(a,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(a){return 0===e[a]};var a=function(a,t){var s,n,r=t[0],u=t[1],i=t[2],o=0;if(r.some(function(a){return 0!==e[a]})){for(s in u)l.o(u,s)&&(l.m[s]=u[s]);if(i)var c=i(l)}for(a&&a(t);o<r.length;o++)n=r[o],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(c)},t=self["webpackChunkdkp_tracker"]=self["webpackChunkdkp_tracker"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))}();var t=l.O(void 0,[504],function(){return l(3363)});t=l.O(t)})();
//# sourceMappingURL=app.39aa656c.js.map