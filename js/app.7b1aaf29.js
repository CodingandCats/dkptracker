(function(){"use strict";var e={8604:function(e,a,l){var t=l(5130),s=l(5753),n=l(6526),r=(l(5524),l(2859)),o=l(3425),u=(l(8111),l(7588),l(1701),l(7642),l(8004),l(3853),l(5876),l(2475),l(5024),l(1698),l(6768)),i=l(144),c=l(4232),d=l(4388);const v=(0,i.KR)(null),m=(0,i.KR)(!1);let p=null;const f=new Promise(e=>{p=e});function b(){const e=(0,u.WQ)("auth");if(!e)throw new Error("Firebase Auth not provided via inject!");return m.value||(0,d.hg)(e,e=>{v.value=e,m.value=!0,p&&p(!0)}),{auth:e,currentUser:v,authInitialized:m,authReady:f}}var g=l(1239);const k={class:"d-flex flex-column gap-3"};function y(e,a,l,s,n,r){const o=(0,u.g2)("v-card-title"),i=(0,u.g2)("v-text-field"),c=(0,u.g2)("v-btn"),d=(0,u.g2)("v-alert"),v=(0,u.g2)("v-form"),m=(0,u.g2)("v-card-text"),p=(0,u.g2)("v-card"),f=(0,u.g2)("v-container");return(0,u.uX)(),(0,u.Wv)(f,{class:"login-container d-flex align-center justify-center"},{default:(0,u.k6)(()=>[(0,u.bF)(p,{class:"login-card pa-8","max-width":"400",width:"100%"},{default:(0,u.k6)(()=>[(0,u.bF)(o,{class:"text-center mb-6"},{default:(0,u.k6)(()=>[...a[3]||(a[3]=[(0,u.Lk)("h2",{class:"login-title"},"The White Order",-1),(0,u.Lk)("div",{class:"login-subtitle"},"DKP Tracker Authentication",-1)])]),_:1}),(0,u.bF)(m,null,{default:(0,u.k6)(()=>[(0,u.bF)(v,{onSubmit:a[2]||(a[2]=(0,t.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(i,{modelValue:e.email,"onUpdate:modelValue":a[0]||(a[0]=a=>e.email=a),label:"Email",type:"email",variant:"outlined",class:"mb-4 login-field","hide-details":"","prepend-inner-icon":"mdi-email"},null,8,["modelValue"]),(0,u.bF)(i,{modelValue:e.password,"onUpdate:modelValue":a[1]||(a[1]=a=>e.password=a),label:"Password",type:"password",variant:"outlined",class:"mb-6 login-field","hide-details":"","prepend-inner-icon":"mdi-lock"},null,8,["modelValue"]),(0,u.Lk)("div",k,[(0,u.bF)(c,{onClick:e.signIn,color:"#1f9ee5",variant:"elevated",size:"large",block:"",class:"login-btn","prepend-icon":"mdi-login"},{default:(0,u.k6)(()=>[...a[4]||(a[4]=[(0,u.eW)(" Sign In ",-1)])]),_:1},8,["onClick"]),(0,u.bF)(c,{onClick:e.signUp,color:"#1f9ee5",variant:"outlined",size:"large",block:"",class:"signup-btn","prepend-icon":"mdi-account-plus"},{default:(0,u.k6)(()=>[...a[5]||(a[5]=[(0,u.eW)(" Sign Up ",-1)])]),_:1},8,["onClick"])]),e.errorMsg?((0,u.uX)(),(0,u.Wv)(d,{key:0,type:"error",variant:"tonal",class:"mt-4",text:e.errorMsg},null,8,["text"])):(0,u.Q3)("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}var h=(0,u.pM)({name:"LogIn",setup(){const e=(0,i.KR)(""),a=(0,i.KR)(""),l=(0,i.KR)(null),t=(0,u.WQ)("auth"),s=(0,u.WQ)("db");if(!t||!s)return console.error("Firebase Auth or Database not provided!"),l.value="Authentication services not available.",{};const n=async()=>{l.value=null;try{const l=await(0,d.eJ)(t,e.value,a.value),n=l.user,r=n.uid;console.log("User signed up! UID:",r);const o=(0,g.KR)(s,`users/${r}/profile`);await(0,g.hZ)(o,{email:n.email,createdAt:(new Date).toISOString()}),console.log("User profile created in RTDB.")}catch(n){console.error("Error signing up:",n.message),l.value=n.message}},r=async()=>{l.value=null;try{await(0,d.x9)(t,e.value,a.value),console.log("User signed in!")}catch(s){console.error("Error signing in:",s.message),l.value=s.message}};return{email:e,password:a,signUp:n,signIn:r,errorMsg:l}}}),_=l(1241);const F=(0,_.A)(h,[["render",y],["__scopeId","data-v-49ad6c2a"]]);var x=F;l(3579);const w={class:"text-subtitle-2 mb-2"};var E={__name:"DkpModal",props:{modelValue:{type:Boolean,required:!0},item:{type:Object,default:null}},emits:["update:modelValue","saved"],setup(e,{emit:a}){const l=e,t=a,s=(0,u.EW)({get:()=>l.modelValue,set:e=>t("update:modelValue",e)}),n=e=>{t("update:modelValue",e)},r=(0,u.WQ)("db"),o=(0,i.KR)(0),d=(0,i.KR)(""),v=(0,i.KR)(""),m=(0,i.KR)(""),p=(0,i.KR)(0),f=(0,i.KR)({}),b=["Field Raids","Epics","Clan Hall/Fort","Call To Arms","Siege"],k=async()=>{if(l.item&&r)try{const e=(0,g.KR)(r,"events/"),a=await(0,g.Jt)(e);if(a.exists()){const e=a.val();let t=0;const s={};b.forEach(e=>{s[e]=0}),Object.values(e).forEach(e=>{if(console.log("Event:",e.messageTitle,"UsersAttended:",e.usersAttended),e.usersAttended){const a=e.messageTitle||"Untitled Event";if(console.log("Event title:",a,"Is in display list:",b.includes(a)),!b.includes(a))return;const n=Object.values(e.usersAttended).some(e=>(console.log("Checking user:",e,"against item:",l.item),e.userId===l.item.id||e.userId===l.item.user||e.username===l.item.user||e.username===l.item.id));n&&(s[a]=(s[a]||0)+1,t++,console.log("User attended event:",a,"New count:",s[a]))}}),console.log("Final attendance by type:",s),console.log("Total attendance:",t),p.value=t,f.value=s}}catch(e){console.error("Error fetching attendance:",e)}};(0,u.wB)(()=>l.item,async e=>{e&&(o.value=e.dkp||0,d.value=e.user||"",v.value=e.class||"",m.value=e.level||"",await k())},{immediate:!0});const y=async()=>{if(l.item&&r&&d.value)try{const e=l.item.isNew?d.value:l.item.id,a=(0,g.KR)(r,`dkp/${e}`);await(0,g.hZ)(a,{user:d.value,dkp:Number(o.value),class:v.value||"",level:m.value||""}),t("update:modelValue",!1),t("saved")}catch(e){console.error("Error saving user:",e)}};return(a,l)=>{const t=(0,u.g2)("v-card-title"),r=(0,u.g2)("v-text-field"),i=(0,u.g2)("v-col"),b=(0,u.g2)("v-list-subheader"),g=(0,u.g2)("v-table"),k=(0,u.g2)("v-row"),h=(0,u.g2)("v-container"),_=(0,u.g2)("v-card-text"),F=(0,u.g2)("v-spacer"),x=(0,u.g2)("v-btn"),E=(0,u.g2)("v-card-actions"),W=(0,u.g2)("v-card"),V=(0,u.g2)("v-dialog");return(0,u.uX)(),(0,u.Wv)(V,{"model-value":s.value,"onUpdate:modelValue":n,"max-width":"500px"},{default:(0,u.k6)(()=>[(0,u.bF)(W,null,{default:(0,u.k6)(()=>[(0,u.bF)(t,{class:"text-h5"},{default:(0,u.k6)(()=>[(0,u.Lk)("span",null,(0,c.v_)(e.item?.isNew?"Add New User":`${e.item?.user} Details`),1)]),_:1}),(0,u.bF)(_,null,{default:(0,u.k6)(()=>[(0,u.bF)(h,null,{default:(0,u.k6)(()=>[(0,u.bF)(k,{justify:"center"},{default:(0,u.k6)(()=>[(0,u.bF)(i,{cols:"12"},{default:(0,u.k6)(()=>[e.item?((0,u.uX)(),(0,u.Wv)(r,{key:0,modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=e=>d.value=e),label:"Username",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,u.Q3)("",!0),e.item?((0,u.uX)(),(0,u.Wv)(r,{key:1,modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=e=>o.value=e),modelModifiers:{number:!0},label:"DKP",type:"number",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,u.Q3)("",!0),e.item?((0,u.uX)(),(0,u.Wv)(r,{key:2,modelValue:v.value,"onUpdate:modelValue":l[2]||(l[2]=e=>v.value=e),label:"Class",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,u.Q3)("",!0),e.item?((0,u.uX)(),(0,u.Wv)(r,{key:3,modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=e=>m.value=e),label:"Level",variant:"outlined",class:"mb-3"},null,8,["modelValue"])):(0,u.Q3)("",!0),(0,u.Lk)("div",w," Total Event Attendance: "+(0,c.v_)(p.value),1)]),_:1}),(0,u.bF)(i,{cols:"12",class:"attendance-list pa-4"},{default:(0,u.k6)(()=>[(0,u.bF)(b,null,{default:(0,u.k6)(()=>[...l[5]||(l[5]=[(0,u.eW)("Attendance by Event Type:",-1)])]),_:1}),(0,u.bF)(g,{dense:""},{header:(0,u.k6)(()=>[...l[6]||(l[6]=[(0,u.Lk)("tr",null,[(0,u.Lk)("th",null,"Event Type"),(0,u.Lk)("th",null,"Attendance Count")],-1)])]),default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(f.value,(e,a)=>((0,u.uX)(),(0,u.CE)("tr",{key:a},[(0,u.Lk)("td",null,(0,c.v_)(a),1),(0,u.Lk)("td",null,(0,c.v_)(e),1)]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),(0,u.bF)(E,null,{default:(0,u.k6)(()=>[(0,u.bF)(F),(0,u.bF)(x,{color:"primary",variant:"text",onClick:l[4]||(l[4]=e=>n(!1))},{default:(0,u.k6)(()=>[...l[7]||(l[7]=[(0,u.eW)(" Cancel ",-1)])]),_:1}),(0,u.bF)(x,{color:"primary",variant:"text",onClick:y},{default:(0,u.k6)(()=>[...l[8]||(l[8]=[(0,u.eW)(" Save ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const W=(0,_.A)(E,[["__scopeId","data-v-040d4274"]]);var V=W;const C={class:"search-container"},R={class:"d-flex align-center justify-center"},U={class:"text-center"},L={class:"text-center"};var K={__name:"DkpTable",props:{users:{type:Array,default:()=>[]},events:{type:Object,default:()=>({})},eventTypes:{type:Array,default:()=>[]},attendanceData:{type:Object,default:()=>({})}},emits:["user-updated"],setup(e,{emit:a}){const l=a,t=(0,i.KR)(""),s=(0,i.KR)(!1),n=(0,i.KR)(null),r=e=>{n.value=e,s.value=!0},o=["Field Raids","Epics","Clan Hall/Fort","Call To Arms","Siege"],d=(0,u.EW)(()=>{const e=[{align:"center",key:"user",sortable:!0,title:"User Name",width:"150px"},{key:"class",align:"center",title:"Class",sortable:!0,width:"120px"},{key:"level",align:"center",title:"Level",sortable:!0,width:"80px"},{key:"dkp",align:"center",title:"DKP",width:"100px",sortable:!0}],a=o.map(e=>({key:`event_${e}`,align:"center",title:e,sortable:!0,width:"100px"}));return[...e,...a,{key:"actions",align:"center",title:"Actions",width:"80px"}]}),v=()=>{l("user-updated")};return(a,l)=>{const o=(0,u.g2)("v-icon"),i=(0,u.g2)("v-text-field"),m=(0,u.g2)("v-btn"),p=(0,u.g2)("v-data-table"),f=(0,u.g2)("v-card");return(0,u.uX)(),(0,u.Wv)(f,{class:"pa-4 mx-auto",id:"card-container"},{title:(0,u.k6)(()=>[...l[2]||(l[2]=[(0,u.Lk)("div",{class:"d-flex py-2"},[(0,u.Lk)("h2",{class:"text-h4 font-weight-bold"}," The White Order Lineage 2 Users ")],-1),(0,u.Lk)("hr",null,null,-1)])]),text:(0,u.k6)(()=>[(0,u.Lk)("div",C,[(0,u.bF)(i,{modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),label:"Search",variant:"underlined","hide-details":"","single-line":"",class:"search-field"},{"prepend-inner":(0,u.k6)(()=>[(0,u.bF)(o,{color:"#1f9ee5"},{default:(0,u.k6)(()=>[...l[3]||(l[3]=[(0,u.eW)("mdi-magnify",-1)])]),_:1})]),_:1},8,["modelValue"])])]),default:(0,u.k6)(()=>[(0,u.bF)(p,{hover:"",headers:d.value,items:e.users,search:t.value,"fixed-header":"",class:"table-container",density:"comfortable"},{["item.user"]:(0,u.k6)(({item:e})=>[(0,u.Lk)("div",R,[(0,u.bF)(o,{color:"#1f9ee5",class:"me-2"},{default:(0,u.k6)(()=>[...l[4]||(l[4]=[(0,u.eW)("mdi-account",-1)])]),_:1}),(0,u.eW)(" "+(0,c.v_)(e.user),1)])]),["item.class"]:(0,u.k6)(({item:e})=>[(0,u.Lk)("div",U,(0,c.v_)(e.class||"-"),1)]),["item.level"]:(0,u.k6)(({item:e})=>[(0,u.Lk)("div",L,(0,c.v_)(e.level||"-"),1)]),["item.actions"]:(0,u.k6)(({item:e})=>[(0,u.bF)(m,{size:"small",icon:"",variant:"text",color:"#1f9ee5",onClick:a=>r(e)},{default:(0,u.k6)(()=>[(0,u.bF)(o,null,{default:(0,u.k6)(()=>[...l[5]||(l[5]=[(0,u.eW)("mdi-pencil",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["headers","items","search"]),(0,u.bF)(V,{modelValue:s.value,"onUpdate:modelValue":l[1]||(l[1]=e=>s.value=e),item:n.value,onSaved:v},null,8,["modelValue","item"])]),_:1})}}};const A=(0,_.A)(K,[["__scopeId","data-v-9a51418a"]]);var X=A,O=(l(4114),l(1527)),P=l.n(O);const I={class:"d-flex justify-space-between align-center py-2"},j={class:"d-flex align-center gap-4"},S={class:"d-flex flex-column"},Q={class:"d-flex align-center"},T={key:0,class:"user-details"},D={key:0},M={key:1},$={key:2},z={class:"d-flex align-center justify-space-between w-100"},N={class:"d-flex align-center"},B={class:"party-count me-2"},J={class:"d-flex flex-column"},Z={class:"d-flex align-center"},H={key:0,class:"user-details"},q={key:0},G={key:1},Y={key:2};var ee={__name:"PartyManager",props:{users:{type:Array,default:()=>[]}},setup(e){const a=e,l=(0,u.WQ)("db"),s=(0,i.KR)(!1),n=(0,i.KR)([]),r=(0,i.KR)([{id:1,name:"Party 1",members:[]},{id:2,name:"Party 2",members:[]},{id:3,name:"Party 3",members:[]},{id:4,name:"Party 4",members:[]}]),o=async e=>{if(l)try{const a=(0,g.KR)(l,"parties"),t=(0,g.P)(a,(0,g.JK)(),(0,g.$1)(1)),s=await(0,g.Jt)(t);if(s.exists()){const a=s.val(),l=Object.values(a)[0];console.log("Loading saved party configuration:",l);const t=new Map;l.unassignedUsers?.forEach(e=>{t.set(e.username,{...e,assignment:"unassigned"})}),l.parties?.forEach(e=>{e.members?.forEach(a=>{t.set(a.username,{...a,assignment:e.id})})}),l.parties&&l.parties.length>0&&(r.value=l.parties.map(e=>({id:e.id,name:e.name||`Party ${e.id}`,members:[]})));const o=[],u={};r.value.forEach(e=>{u[e.id]=[]}),e.forEach(e=>{const a=t.get(e.username);a&&"unassigned"!==a.assignment&&u[a.assignment]?u[a.assignment].push(e):o.push(e)}),n.value=o,r.value.forEach(e=>{e.members=u[e.id]||[]}),console.log("Party configuration loaded successfully")}else console.log("No saved party configuration found, using default"),n.value=e}catch(a){console.error("Error loading party configuration:",a),n.value=e}else n.value=e},d=async()=>{const e=a.users.map(e=>({username:e.user,class:e.class||"",level:e.level||""})).sort((e,a)=>e.username.localeCompare(a.username));await o(e)};(0,u.wB)(()=>a.users,async()=>{await d()},{immediate:!0}),(0,u.sV)(async()=>{a.users.length>0&&await d()});const v=()=>{const e=Math.max(...r.value.map(e=>e.id))+1;r.value.push({id:e,name:`Party ${e}`,members:[]})},m=e=>{const a=r.value[e];n.value.push(...a.members),r.value.splice(e,1),console.log(`Party "${a.name}" deleted locally. Click Save to persist changes.`)},p=async()=>{if(l){s.value=!0;try{const e=new Date,a=e.toISOString(),t=a.replace(/[.#$[\]]/g,"_"),s={timestamp:a,unassignedUsers:n.value,parties:r.value.map(e=>({id:e.id,name:e.name,members:e.members,memberCount:e.members.length}))},o=(0,g.KR)(l,`parties/${t}`);await(0,g.hZ)(o,s),console.log("Parties saved successfully!",s)}catch(e){console.error("Error saving parties:",e)}finally{s.value=!1}}else console.error("Database not available")};return(e,a)=>{const l=(0,u.g2)("v-btn"),o=(0,u.g2)("v-col"),d=(0,u.g2)("v-row"),f=(0,u.g2)("v-card-title"),b=(0,u.g2)("v-icon"),g=(0,u.g2)("v-card-text"),k=(0,u.g2)("v-card"),y=(0,u.g2)("v-text-field"),h=(0,u.g2)("v-container");return(0,u.uX)(),(0,u.Wv)(h,{fluid:"",class:"pa-0"},{default:(0,u.k6)(()=>[(0,u.bF)(d,null,{default:(0,u.k6)(()=>[(0,u.bF)(o,{cols:"12"},{default:(0,u.k6)(()=>[(0,u.Lk)("div",I,[a[5]||(a[5]=(0,u.Lk)("h2",{class:"text-h4 font-weight-bold"},"Party Members",-1)),(0,u.Lk)("div",j,[(0,u.bF)(l,{onClick:v,variant:"tonal",color:"#1f9ee5","prepend-icon":"mdi-plus"},{default:(0,u.k6)(()=>[...a[2]||(a[2]=[(0,u.eW)(" Add Party ",-1)])]),_:1}),(0,u.bF)(l,{onClick:p,variant:"tonal",color:"success","prepend-icon":"mdi-content-save",loading:s.value,class:"mx-4"},{default:(0,u.k6)(()=>[...a[3]||(a[3]=[(0,u.eW)(" Save Parties ",-1)])]),_:1},8,["loading"]),a[4]||(a[4]=(0,u.Lk)("span",{class:"text-caption text-medium-emphasis"}," Use DKP Table to add/edit users ",-1))])]),a[6]||(a[6]=(0,u.Lk)("hr",null,null,-1))]),_:1})]),_:1}),(0,u.bF)(d,null,{default:(0,u.k6)(()=>[(0,u.bF)(o,{cols:"12",lg:"3"},{default:(0,u.k6)(()=>[(0,u.bF)(k,{class:"party-card",id:"user-pool-card"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{class:"text-center"},{default:(0,u.k6)(()=>[...a[7]||(a[7]=[(0,u.eW)("Available Users",-1)])]),_:1}),(0,u.bF)(g,null,{default:(0,u.k6)(()=>[(0,u.bF)((0,i.R1)(P()),{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),group:"users","item-key":"username",class:"user-pool"},{item:(0,u.k6)(({element:e})=>[(0,u.bF)(k,{class:"user-card mb-2"},{default:(0,u.k6)(()=>[(0,u.bF)(g,{class:"d-flex align-center"},{default:(0,u.k6)(()=>[(0,u.Lk)("div",S,[(0,u.Lk)("div",Q,[(0,u.bF)(b,{color:"#1f9ee5",class:"me-2"},{default:(0,u.k6)(()=>[...a[8]||(a[8]=[(0,u.eW)("mdi-account",-1)])]),_:1}),(0,u.eW)(" "+(0,c.v_)(e.username),1)]),e.class||e.level?((0,u.uX)(),(0,u.CE)("div",T,[e.class?((0,u.uX)(),(0,u.CE)("span",D,(0,c.v_)(e.class),1)):(0,u.Q3)("",!0),e.class&&e.level?((0,u.uX)(),(0,u.CE)("span",M," · ")):(0,u.Q3)("",!0),e.level?((0,u.uX)(),(0,u.CE)("span",$,"Level "+(0,c.v_)(e.level),1)):(0,u.Q3)("",!0)])):(0,u.Q3)("",!0)])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,u.bF)(o,{cols:"12",lg:"7"},{default:(0,u.k6)(()=>[(0,u.bF)(d,{style:{width:"100%"}},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r.value,(e,s)=>((0,u.uX)(),(0,u.Wv)(o,{key:s,cols:"4"},{default:(0,u.k6)(()=>[(0,u.bF)(k,{class:"party-card"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{class:"text-center party-title-container"},{default:(0,u.k6)(()=>[(0,u.Lk)("div",z,[(0,u.bF)(y,{modelValue:e.name,"onUpdate:modelValue":a=>e.name=a,variant:"plain",class:"party-name-field","hide-details":"",density:"compact",onClick:a[1]||(a[1]=(0,t.D$)(()=>{},["stop"]))},null,8,["modelValue","onUpdate:modelValue"]),(0,u.Lk)("div",N,[(0,u.Lk)("span",B,"("+(0,c.v_)(e.members.length)+")",1),(0,u.bF)(l,{icon:"",size:"small",variant:"text",color:"error",onClick:e=>m(s)},{default:(0,u.k6)(()=>[(0,u.bF)(b,{size:"medium"},{default:(0,u.k6)(()=>[...a[9]||(a[9]=[(0,u.eW)("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])])])]),_:2},1024),(0,u.bF)(g,null,{default:(0,u.k6)(()=>[(0,u.bF)((0,i.R1)(P()),{modelValue:e.members,"onUpdate:modelValue":a=>e.members=a,group:"users","item-key":"username",class:"party-drop-zone"},{item:(0,u.k6)(({element:e})=>[(0,u.bF)(k,{class:"user-card mb-1"},{default:(0,u.k6)(()=>[(0,u.bF)(g,{class:"d-flex align-center"},{default:(0,u.k6)(()=>[(0,u.Lk)("div",J,[(0,u.Lk)("div",Z,[(0,u.bF)(b,{color:"#1f9ee5",class:"me-2"},{default:(0,u.k6)(()=>[...a[10]||(a[10]=[(0,u.eW)("mdi-account",-1)])]),_:1}),(0,u.eW)(" "+(0,c.v_)(e.username),1)]),e.class||e.level?((0,u.uX)(),(0,u.CE)("div",H,[e.class?((0,u.uX)(),(0,u.CE)("span",q,(0,c.v_)(e.class),1)):(0,u.Q3)("",!0),e.class&&e.level?((0,u.uX)(),(0,u.CE)("span",G," · ")):(0,u.Q3)("",!0),e.level?((0,u.uX)(),(0,u.CE)("span",Y,"Level "+(0,c.v_)(e.level),1)):(0,u.Q3)("",!0)])):(0,u.Q3)("",!0)])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}}};const ae=(0,_.A)(ee,[["__scopeId","data-v-b68cd1dc"]]);var le=ae;const te={class:"d-flex justify-space-between align-center my-3"},se={class:"d-flex align-center"},ne={key:0},re={key:1},oe={key:1,class:"text-center pa-4"};var ue={__name:"App",setup(e){const{auth:a,currentUser:l}=b(),t=(0,i.KR)("dkp-table"),s=(0,i.KR)([]),n=(0,i.KR)([]),r=(0,i.KR)([]),o=(0,i.KR)({}),v=(0,i.KR)(!0),m=(0,u.WQ)("db"),p=async()=>{if(m)try{const e=(0,g.KR)(m,"events/"),a=await(0,g.Jt)(e);if(a.exists()){const e=a.val();n.value=e;const l=new Set,t={};Object.values(e).forEach(e=>{const a=e.messageTitle||"Untitled Event";l.add(a)}),Object.values(e).forEach(e=>{const a=e.messageTitle||"Untitled Event";e.usersAttended&&Object.values(e.usersAttended).forEach(e=>{t[e.userId]||(t[e.userId]={}),t[e.userId][a]=(t[e.userId][a]||0)+1})}),r.value=Array.from(l),o.value=t}}catch(e){console.error("Error fetching events:",e)}},f=async()=>{if(m)try{const e=(0,g.KR)(m,"dkp/");return(0,g.Zy)(e,e=>{const a=e.val();if(a){const e=Object.entries(a).map(([e,a])=>{const l={id:e,...a};return r.value.forEach(a=>{l[`event_${a}`]=o.value[e]?.[a]||0}),l});s.value=e.sort((e,a)=>e.user.localeCompare(a.user))}else s.value=[];v.value=!1},e=>{console.error("Database read error:",e),v.value=!1})}catch(e){console.error("Error setting up database listener:",e),v.value=!1}};(0,u.wB)(l,async e=>{e&&(v.value=!0,await p(),await f())}),(0,u.sV)(async()=>{l.value&&(v.value=!0,await p(),await f())});const k=async()=>{try{await(0,d.CI)(a),console.log("User signed out successfully.")}catch(e){console.error("Error signing out:",e.message)}},y=()=>{f()};return(e,a)=>{const d=(0,u.g2)("v-btn"),m=(0,u.g2)("v-tab"),p=(0,u.g2)("v-tabs"),f=(0,u.g2)("v-container"),b=(0,u.g2)("v-app-bar"),g=(0,u.g2)("v-progress-circular"),h=(0,u.g2)("v-main"),_=(0,u.g2)("v-app");return(0,u.uX)(),(0,u.Wv)(_,null,{default:(0,u.k6)(()=>[(0,u.bF)(b,{class:"px-0"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{id:"app-bar",fluid:""},{default:(0,u.k6)(()=>[(0,u.Lk)("div",te,[(0,u.Lk)("div",se,[(0,i.R1)(l)?((0,u.uX)(),(0,u.CE)("span",ne,"Welcome, "+(0,c.v_)((0,i.R1)(l).email),1)):((0,u.uX)(),(0,u.CE)("span",re,"Please sign in"))]),(0,i.R1)(l)?((0,u.uX)(),(0,u.Wv)(d,{key:0,onClick:k,variant:"tonal",class:"sign-out-btn"},{default:(0,u.k6)(()=>[...a[1]||(a[1]=[(0,u.eW)(" Sign Out ",-1)])]),_:1})):(0,u.Q3)("",!0)]),(0,i.R1)(l)?((0,u.uX)(),(0,u.Wv)(p,{key:0,modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),color:"#1f9ee5","align-tabs":"left",class:"mt-8"},{default:(0,u.k6)(()=>[(0,u.bF)(m,{value:"dkp-table",class:"custom-tab"},{default:(0,u.k6)(()=>[...a[2]||(a[2]=[(0,u.eW)("Guild Members",-1)])]),_:1}),(0,u.bF)(m,{value:"parties",class:"custom-tab"},{default:(0,u.k6)(()=>[...a[3]||(a[3]=[(0,u.eW)("Party Manager",-1)])]),_:1})]),_:1},8,["modelValue"])):(0,u.Q3)("",!0)]),_:1})]),_:1}),(0,u.bF)(h,{class:"mt-12"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{id:"main-container"},{default:(0,u.k6)(()=>[(0,i.R1)(l)?v.value?((0,u.uX)(),(0,u.CE)("div",oe,[(0,u.bF)(g,{indeterminate:"",color:"#1f9ee5"}),a[4]||(a[4]=(0,u.Lk)("p",{class:"mt-2",style:{color:"#eaf1ff"}},"Loading data...",-1))])):"dkp-table"===t.value?((0,u.uX)(),(0,u.Wv)(X,{key:2,users:s.value,events:n.value,"event-types":r.value,"attendance-data":o.value,onUserUpdated:y},null,8,["users","events","event-types","attendance-data"])):"parties"===t.value?((0,u.uX)(),(0,u.Wv)(le,{key:3,users:s.value,onUserUpdated:y},null,8,["users"])):(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)(x,{key:0}))]),_:1})]),_:1})]),_:1})}}};const ie=ue;var ce=ie,de=l(6400);const ve={apiKey:"AIzaSyARl2Ai3AP9JPwKeZ-vustpvsC5RNW-YD4",authDomain:"dkptracker-6121c.firebaseapp.com",databaseURL:"https://dkptracker-6121c-default-rtdb.firebaseio.com",projectId:"dkptracker-6121c",storageBucket:"dkptracker-6121c.firebasestorage.app",messagingSenderId:"1047085462747",appId:"1:1047085462747:web:a5b6e403a81f29420fc8fe"},me=(0,de.Wp)(ve),pe=(0,d.xI)(me),fe=(0,g.C3)(me),be=(0,s.$N)({components:r,directives:o,icons:{defaultSet:"mdi",aliases:n.z,sets:{mdi:n.r}}}),ge=(0,t.Ef)(ce);ge.provide("db",fe),ge.provide("auth",pe),ge.use(be),ge.mount("#app")}},a={};function l(t){var s=a[t];if(void 0!==s)return s.exports;var n=a[t]={exports:{}};return e[t].call(n.exports,n,n.exports,l),n.exports}l.m=e,function(){var e=[];l.O=function(a,t,s,n){if(!t){var r=1/0;for(c=0;c<e.length;c++){t=e[c][0],s=e[c][1],n=e[c][2];for(var o=!0,u=0;u<t.length;u++)(!1&n||r>=n)&&Object.keys(l.O).every(function(e){return l.O[e](t[u])})?t.splice(u--,1):(o=!1,n<r&&(r=n));if(o){e.splice(c--,1);var i=s();void 0!==i&&(a=i)}}return a}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[t,s,n]}}(),function(){l.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(a,{a:a}),a}}(),function(){l.d=function(e,a){for(var t in a)l.o(a,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(a){return 0===e[a]};var a=function(a,t){var s,n,r=t[0],o=t[1],u=t[2],i=0;if(r.some(function(a){return 0!==e[a]})){for(s in o)l.o(o,s)&&(l.m[s]=o[s]);if(u)var c=u(l)}for(a&&a(t);i<r.length;i++)n=r[i],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(c)},t=self["webpackChunkdkp_tracker"]=self["webpackChunkdkp_tracker"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))}();var t=l.O(void 0,[504],function(){return l(8604)});t=l.O(t)})();
//# sourceMappingURL=app.7b1aaf29.js.map