(function(){"use strict";var e={3704:function(e,n,t){var r=t(5130),a=t(5753),o=(t(8111),t(3579),t(1387)),l=t(144),s=t(6768),i=t(4388);const u=(0,l.KR)(null),c=(0,l.KR)(!1);let d=null;const p=new Promise(e=>{d=e});function g(){const e=(0,s.WQ)("auth");if(!e)throw new Error("Firebase Auth not provided via inject!");return c.value||(0,i.hg)(e,e=>{u.value=e,c.value=!0,d&&d(!0)}),{auth:e,currentUser:u,authInitialized:c,authReady:p}}var v=t(4232);const f={key:0,class:"error"};function h(e,n,t,a,o,l){return(0,s.uX)(),(0,s.CE)("div",null,[n[4]||(n[4]=(0,s.Lk)("h2",null,"Email/Password Authentication",-1)),(0,s.bo)((0,s.Lk)("input",{type:"email","onUpdate:modelValue":n[0]||(n[0]=n=>e.email=n),placeholder:"Email"},null,512),[[r.Jo,e.email]]),(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=n=>e.password=n),placeholder:"Password"},null,512),[[r.Jo,e.password]]),(0,s.Lk)("button",{onClick:n[2]||(n[2]=(...n)=>e.signUp&&e.signUp(...n))},"Sign Up"),(0,s.Lk)("button",{onClick:n[3]||(n[3]=(...n)=>e.signIn&&e.signIn(...n))},"Sign In"),e.errorMsg?((0,s.uX)(),(0,s.CE)("p",f,(0,v.v_)(e.errorMsg),1)):(0,s.Q3)("",!0)])}var b=t(1239),m=(0,s.pM)({name:"LogIn",setup(){const e=(0,l.KR)(""),n=(0,l.KR)(""),t=(0,l.KR)(null),r=(0,s.WQ)("auth"),a=(0,s.WQ)("db");if(console.log(a),!r||!a)return console.error("Firebase Auth or Database not provided!"),t.value="Authentication services not available.",{};const o=async()=>{t.value=null;try{const t=await(0,i.eJ)(r,e.value,n.value),o=t.user,l=o.uid;console.log("User signed up! UID:",l);const s=(0,b.KR)(a,`users/${l}/profile`);await(0,b.hZ)(s,{email:o.email,createdAt:(new Date).toISOString()}),console.log("User profile created in RTDB.")}catch(o){console.error("Error signing up:",o.message),t.value=o.message}},u=async()=>{t.value=null;try{await(0,i.x9)(r,e.value,n.value),console.log("User signed in!")}catch(a){console.error("Error signing in:",a.message),t.value=a.message}};return{email:e,password:n,signUp:o,signIn:u,errorMsg:t}}}),k=t(1241);const y=(0,k.A)(m,[["render",h],["__scopeId","data-v-d6d09536"]]);var w=y;t(1701);const _={class:"container"};var R={__name:"DkpTable",setup(e){const n=(0,l.KR)(""),t=(0,l.KR)([]),r=(0,s.WQ)("db"),a=[{align:"center",key:"user",sortable:!1,title:"User Name"},{key:"dkp",align:"center",title:"DKP"}];async function o(){if(r)try{console.log("Attempting to fetch data from path: dkp/");const e=(0,b.KR)(r,"dkp/");return(0,b.Zy)(e,e=>{console.log("Snapshot received:",e.exists(),e.val());const n=e.val();if(n){console.log("Processing data:",n);const e=Object.entries(n).map(([e,n])=>({id:e,...n}));console.log("Processed data:",e),t.value=e.sort((e,n)=>e.user.localeCompare(n.user))}else console.log("No data found in snapshot"),t.value=[]},e=>{console.error("Database read error:",e)})}catch(e){console.error("Error setting up database listener:",e)}else console.error("Database not available")}return(0,s.sV)(()=>{o()}),(e,r)=>{const o=(0,s.g2)("v-text-field"),l=(0,s.g2)("v-data-table"),i=(0,s.g2)("v-card");return(0,s.uX)(),(0,s.CE)("div",_,[(0,s.bF)(i,{title:"The White Order Lineage 2 DKP",class:"elevation-2"},{text:(0,s.k6)(()=>[(0,s.bF)(o,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=e=>n.value=e),label:"Search","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",width:"300"},null,8,["modelValue"])]),default:(0,s.k6)(()=>[(0,s.bF)(l,{headers:a,items:t.value,search:n.value},null,8,["items","search"])]),_:1})])}}};const I=(0,k.A)(R,[["__scopeId","data-v-9c944544"]]);var U=I;const O=[{path:"/",redirect:"/login"},{path:"/dkp-table",name:"dkp-table",component:U,meta:{requiresAuth:!0}},{path:"/log-in",name:"login",component:w},{path:"/:pathMatch(.*)*",redirect:"/dkp-table"}],A=(0,o.aE)({history:(0,o.LA)("/dkptracker/"),routes:O});A.beforeEach(async(e,n,t)=>{const{currentUser:r,authInitialized:a,authReady:o}=g();a.value||await o;const l=e.matched.some(e=>e.meta.requiresAuth);l&&!r.value?(console.log("Redirecting to login. Requires auth but user is null."),t({name:"login"})):"login"===e.name&&r.value?(console.log("Redirecting from login/register. User is already logged in."),t({name:"dkp-table"})):t()});var E=A,C=(t(5524),t(2859)),P=t(3425);t(4114);const S={key:0},K={key:1};var j={__name:"App",setup(e){const{auth:n,currentUser:t}=g(),r=(0,o.rd)(),a=async()=>{try{await(0,i.CI)(n),r.push("/login"),console.log("User signed out successfully.")}catch(e){console.error("Error signing out:",e.message)}};return(e,n)=>{const r=(0,s.g2)("v-spacer"),o=(0,s.g2)("v-btn"),i=(0,s.g2)("v-container"),u=(0,s.g2)("v-app-bar"),c=(0,s.g2)("router-view"),d=(0,s.g2)("v-main"),p=(0,s.g2)("v-app");return(0,s.uX)(),(0,s.Wv)(p,null,{default:(0,s.k6)(()=>[(0,s.bF)(u,null,{default:(0,s.k6)(()=>[(0,s.bF)(i,null,{default:(0,s.k6)(()=>[(0,l.R1)(t)?((0,s.uX)(),(0,s.CE)("span",S,"Welcome, "+(0,v.v_)((0,l.R1)(t).email),1)):((0,s.uX)(),(0,s.CE)("span",K,"Please sign in")),(0,s.bF)(r),(0,l.R1)(t)?((0,s.uX)(),(0,s.Wv)(o,{key:2,onClick:a},{default:(0,s.k6)(()=>[...n[0]||(n[0]=[(0,s.eW)("Sign Out",-1)])]),_:1})):(0,s.Q3)("",!0)]),_:1})]),_:1}),(0,s.bF)(d,null,{default:(0,s.k6)(()=>[(0,s.bF)(i,null,{default:(0,s.k6)(()=>[(0,s.bF)(c)]),_:1})]),_:1})]),_:1})}}};const D=j;var F=D,W=t(6400);const x={apiKey:"AIzaSyARl2Ai3AP9JPwKeZ-vustpvsC5RNW-YD4",authDomain:"dkptracker-6121c.firebaseapp.com",databaseURL:"https://dkptracker-6121c-default-rtdb.firebaseio.com",projectId:"dkptracker-6121c",storageBucket:"dkptracker-6121c.firebasestorage.app",messagingSenderId:"1047085462747",appId:"1:1047085462747:web:a5b6e403a81f29420fc8fe"},L=(0,W.Wp)(x),M=(0,i.xI)(L),T=(0,b.C3)(L);console.log("main.js: dbInstance after getDatabase:",T);const X=(0,a.$N)({components:C,directives:P}),Q=(0,r.Ef)(F);Q.provide("db",T),Q.provide("auth",M),Q.use(X),Q.use(E),Q.mount("#app")}},n={};function t(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={exports:{}};return e[r].call(o.exports,o,o.exports,t),o.exports}t.m=e,function(){var e=[];t.O=function(n,r,a,o){if(!r){var l=1/0;for(c=0;c<e.length;c++){r=e[c][0],a=e[c][1],o=e[c][2];for(var s=!0,i=0;i<r.length;i++)(!1&o||l>=o)&&Object.keys(t.O).every(function(e){return t.O[e](r[i])})?r.splice(i--,1):(s=!1,o<l&&(l=o));if(s){e.splice(c--,1);var u=a();void 0!==u&&(n=u)}}return n}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[r,a,o]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(n){return 0===e[n]};var n=function(n,r){var a,o,l=r[0],s=r[1],i=r[2],u=0;if(l.some(function(n){return 0!==e[n]})){for(a in s)t.o(s,a)&&(t.m[a]=s[a]);if(i)var c=i(t)}for(n&&n(r);u<l.length;u++)o=l[u],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(c)},r=self["webpackChunkdkp_tracker"]=self["webpackChunkdkp_tracker"]||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))}();var r=t.O(void 0,[504],function(){return t(3704)});r=t.O(r)})();
//# sourceMappingURL=app.cc1b502c.js.map